import{c as kt,r as mt,u as xt,j as t,b as Ae,H as Ct,L as ft}from"./app-CCLGgt9A.js";import{B as m}from"./badge-CEJYDWgW.js";import{b as St,B as K}from"./createLucideIcon-CVcoGLu5.js";import{d as Q,C as J,a as at,b as rt}from"./card-Br5wvBQA.js";import{a as Et,g as Ft,e as Tt,f as Dt,D as Lt}from"./dialog-COaNvud1.js";import{I as lt}from"./input-Ciprp9h8.js";import{L as G}from"./label-CtaEkbf1.js";import{A as Mt,U as pt,C as ht}from"./app-layout-Dyev4des.js";import{C as $t}from"./clock-3-BKJlTi0-.js";import{S as It}from"./store-DMoPKgGT.js";import{P as Pt}from"./package-Dr5e9o90.js";import{M as Rt}from"./map-pin-B2hwvXmJ.js";import{T as Ot}from"./trending-up-BUMmlPMn.js";import{S as gt}from"./search-CdjmjqyU.js";import{C as ut}from"./chevron-left-giBkOoKY.js";/* empty css            */import"./index-DCgq7HkD.js";import"./index-ig6vlWR_.js";import"./index-C8o9R0tm.js";const Bt=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],At=St("MessageSquare",Bt),Ht=[{title:"Customers",href:"/staff/customers"}];function bt(a){return new Intl.NumberFormat("en-ET",{style:"currency",currency:"ETB",maximumFractionDigits:2}).format(a)}function Ut(a){return a==="telegram"?"Telegram":a==="table"?"Table":"Web"}function qt(a){return a==="telegram"?"bg-sky-50 text-sky-700 ring-1 ring-sky-200":a==="table"?"bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200":"bg-zinc-100 text-zinc-700 ring-1 ring-zinc-200"}function js(a){const e=kt.c(161),{customers:i,selectedCustomer:n,filters:jt,smsTemplates:p,smsPlaceholders:nt,summary:u}=a;let X;e[0]===Symbol.for("react.memo_cache_sentinel")?(X=[],e[0]=X):X=e[0];const[c,He]=mt.useState(X),Ue=jt.search??"";let Y;e[1]!==Ue?(Y={search:Ue},e[1]=Ue,e[2]=Y):Y=e[2];const o=xt(Y);let Z;e[3]===Symbol.for("react.memo_cache_sentinel")?(Z=[],e[3]=Z):Z=e[3];let ee;e[4]===Symbol.for("react.memo_cache_sentinel")?(ee={customer_ids:Z,platform:"sms",message:"",telegram_button_text:"",telegram_button_url:""},e[4]=ee):ee=e[4];const s=xt(ee),ct=mt.useRef(null),x=s.data.platform==="telegram",h=x?2e3:480;let te;e[5]!==x||e[6]!==s.data.telegram_button_text||e[7]!==s.data.telegram_button_url?(te=x&&s.data.telegram_button_text.trim()===""!=(s.data.telegram_button_url.trim()===""),e[5]=x,e[6]=s.data.telegram_button_text,e[7]=s.data.telegram_button_url,e[8]=te):te=e[8];const g=te;let qe;e:{if(i.data.length===0){qe=!1;break e}let r;if(e[9]!==i.data||e[10]!==c){let l;e[12]!==c?(l=d=>c.includes(d.id),e[12]=c,e[13]=l):l=e[13],r=i.data.every(l),e[9]=i.data,e[10]=c,e[11]=r}else r=e[11];qe=r}const f=qe;let se;e[14]===Symbol.for("react.memo_cache_sentinel")?(se=r=>{He(l=>l.includes(r)?l.filter(d=>d!==r):[...l,r])},e[14]=se):se=e[14];const Nt=se;let ae;e[15]!==i.data||e[16]!==f?(ae=()=>{if(f){He(r=>r.filter(l=>!i.data.some(d=>d.id===l)));return}He(r=>[...new Set([...r,...i.data.map(Zt)])])},e[15]=i.data,e[16]=f,e[17]=ae):ae=e[17];const Ve=ae;let re;e[18]!==o.data?(re=r=>{r.preventDefault(),Ae.get("/staff/customers",o.data,{preserveState:!0,replace:!0})},e[18]=o.data,e[19]=re):re=e[19];const We=re;let le;e[20]!==c||e[21]!==s?(le=r=>{r.preventDefault(),s.transform(l=>({...l,customer_ids:c})),s.post("/staff/customers/sms",{preserveScroll:!0,onSuccess:()=>{s.reset("message","telegram_button_text","telegram_button_url")}})},e[20]=c,e[21]=s,e[22]=le):le=e[22];const _t=le,yt=r=>{const l=`{${r}}`,d=ct.current,Be=s.data.message;if(!d){s.setData("message",`${Be}${l}`.slice(0,h));return}const st=d.selectionStart??Be.length,zt=d.selectionEnd??st,it=`${Be.slice(0,st)}${l}${Be.slice(zt)}`.slice(0,h);s.setData("message",it);const ot=Math.min(st+l.length,it.length),dt=()=>{d.focus(),d.setSelectionRange(ot,ot)};if(typeof window<"u"){window.requestAnimationFrame(dt);return}dt()};let ne;e[23]!==o.data.search?(ne=()=>{if(typeof window>"u"){Ae.get("/staff/customers",{search:o.data.search||void 0},{preserveState:!0,preserveScroll:!0,replace:!0});return}const r=new URLSearchParams(window.location.search);r.delete("customer_id");const l=r.toString(),d=l.length>0?`/staff/customers?${l}`:"/staff/customers";Ae.get(d,{},{preserveState:!0,preserveScroll:!0,replace:!0})},e[23]=o.data.search,e[24]=ne):ne=e[24];const Ge=ne;let ce;e[25]===Symbol.for("react.memo_cache_sentinel")?(ce=t.jsx(Ct,{title:"Customers"}),e[25]=ce):ce=e[25];let ie;e[26]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-[#9E9E9E]",children:"Total Customers"}),e[26]=ie):ie=e[26];let b;e[27]!==u.total_customers?(b=u.total_customers.toLocaleString(),e[27]=u.total_customers,e[28]=b):b=e[28];let j;e[29]!==b?(j=t.jsxs("div",{children:[ie,t.jsx("h3",{className:"mt-2 text-3xl font-black text-[#212121]",children:b})]}),e[29]=b,e[30]=j):j=e[30];let oe;e[31]===Symbol.for("react.memo_cache_sentinel")?(oe=t.jsx("div",{className:"rounded-2xl bg-[#F57C00]/10 p-3 text-[#F57C00]",children:t.jsx(pt,{className:"size-6"})}),e[31]=oe):oe=e[31];let N;e[32]!==j?(N=t.jsx(Q,{className:"border-none shadow-sm ring-1 ring-zinc-200",children:t.jsx(J,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[j,oe]})})}),e[32]=j,e[33]=N):N=e[33];let de;e[34]===Symbol.for("react.memo_cache_sentinel")?(de=t.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-emerald-500",children:"Active (With Orders)"}),e[34]=de):de=e[34];let _;e[35]!==u.active_customers?(_=u.active_customers.toLocaleString(),e[35]=u.active_customers,e[36]=_):_=e[36];let y;e[37]!==_?(y=t.jsxs("div",{children:[de,t.jsx("h3",{className:"mt-2 text-3xl font-black text-[#212121]",children:_})]}),e[37]=_,e[38]=y):y=e[38];let me;e[39]===Symbol.for("react.memo_cache_sentinel")?(me=t.jsx("div",{className:"rounded-2xl bg-emerald-50 p-3 text-emerald-500",children:t.jsx(Ot,{className:"size-6"})}),e[39]=me):me=e[39];let v;e[40]!==y?(v=t.jsx(Q,{className:"border-none shadow-sm ring-1 ring-zinc-200",children:t.jsx(J,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[y,me]})})}),e[40]=y,e[41]=v):v=e[41];let xe;e[42]!==N||e[43]!==v?(xe=t.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[N,v]}),e[42]=N,e[43]=v,e[44]=xe):xe=e[44];let pe;e[45]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsx(at,{className:"border-b border-zinc-100 bg-zinc-50/50 py-4",children:t.jsxs(rt,{className:"flex items-center gap-2 text-sm font-black uppercase tracking-widest text-[#212121]",children:[t.jsx(gt,{className:"size-4 text-[#F57C00]"}),"Search Database"]})}),e[45]=pe):pe=e[45];let he;e[46]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx(G,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"search",children:"Name or Phone Number"}),e[46]=he):he=e[46];let ge;e[47]===Symbol.for("react.memo_cache_sentinel")?(ge=t.jsx(gt,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-zinc-400"}),e[47]=ge):ge=e[47];let w;e[48]!==o?(w=r=>o.setData("search",r.target.value),e[48]=o,e[49]=w):w=e[49];let z;e[50]!==o.data.search||e[51]!==w?(z=t.jsxs("div",{className:"min-w-[300px] flex-1",children:[he,t.jsxs("div",{className:"relative mt-1.5",children:[ge,t.jsx(lt,{id:"search",className:"h-11 pl-10 rounded-xl border-zinc-200 focus:ring-[#F57C00] transition-all",value:o.data.search,onChange:w,placeholder:"Enter name, phone, @username, or Telegram ID..."})]})]}),e[50]=o.data.search,e[51]=w,e[52]=z):z=e[52];let ue,fe;e[53]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsx(K,{type:"submit",className:"h-11 px-8 rounded-xl bg-[#F57C00] font-black shadow-lg shadow-[#F57C00]/20 hover:bg-[#E65100]",children:"Apply Filter"}),fe=t.jsx(K,{type:"button",variant:"outline",className:"h-11 rounded-xl font-bold border-zinc-200",onClick:Yt,children:"Reset"}),e[53]=ue,e[54]=fe):(ue=e[53],fe=e[54]);let be;e[55]!==We||e[56]!==z?(be=t.jsxs(Q,{className:"border-none shadow-md ring-1 ring-zinc-200",children:[pe,t.jsx(J,{className:"pt-6",children:t.jsxs("form",{className:"flex flex-wrap items-end gap-3",onSubmit:We,children:[z,ue,fe]})})]}),e[55]=We,e[56]=z,e[57]=be):be=e[57];let je;e[58]===Symbol.for("react.memo_cache_sentinel")?(je=t.jsxs(rt,{className:"flex items-center gap-2 text-sm font-black uppercase tracking-widest text-[#212121]",children:[t.jsx(pt,{className:"size-4 text-[#F57C00]"}),"Customer Directory"]}),e[58]=je):je=e[58];let k;e[59]!==c.length?(k=c.length>0&&t.jsxs(m,{className:"bg-[#F57C00] font-black uppercase tracking-tighter shadow-none",children:[c.length," Selected"]}),e[59]=c.length,e[60]=k):k=e[60];let C;e[61]!==k?(C=t.jsx(at,{className:"border-b border-zinc-100 bg-white py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[je,k]})}),e[61]=k,e[62]=C):C=e[62];let S;e[63]!==f||e[64]!==Ve?(S=t.jsx("th",{className:"w-12 px-6 py-4",children:t.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-zinc-300 text-[#F57C00] focus:ring-[#F57C00]/20",checked:f,onChange:Ve})}),e[63]=f,e[64]=Ve,e[65]=S):S=e[65];let Ne,_e,ye,ve;e[66]===Symbol.for("react.memo_cache_sentinel")?(Ne=t.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Customer Info"}),_e=t.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Order Stats"}),ye=t.jsx("th",{className:"px-6 py-4 text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Volume"}),ve=t.jsx("th",{className:"px-6 py-4 text-right text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Actions"}),e[66]=Ne,e[67]=_e,e[68]=ye,e[69]=ve):(Ne=e[66],_e=e[67],ye=e[68],ve=e[69]);let E;e[70]!==S?(E=t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-zinc-100 bg-zinc-50/50",children:[S,Ne,_e,ye,ve]})}),e[70]=S,e[71]=E):E=e[71];let F;if(e[72]!==i.data||e[73]!==o.data.search||e[74]!==c){let r;e[76]!==o.data.search||e[77]!==c?(r=l=>t.jsxs("tr",{className:"group border-b border-zinc-50 transition-colors hover:bg-zinc-50/50 last:border-0",children:[t.jsx("td",{className:"px-6 py-4",children:t.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-zinc-300 text-[#F57C00] focus:ring-[#F57C00]/20",checked:c.includes(l.id),onChange:()=>Nt(l.id)})}),t.jsx("td",{className:"px-6 py-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-zinc-100 text-xs font-black text-zinc-500 transition-colors group-hover:bg-[#F57C00]/10 group-hover:text-[#F57C00]",children:l.name.charAt(0)}),t.jsxs("div",{children:[t.jsx("p",{className:"font-bold text-[#212121]",children:l.name}),t.jsx("p",{className:"text-xs font-medium text-zinc-500",children:l.phone}),l.telegram_username&&t.jsxs("p",{className:"text-[11px] font-semibold text-sky-600",children:["@",l.telegram_username]}),l.telegram_id&&t.jsxs("p",{className:"text-[10px] font-semibold text-zinc-400",children:["TG ID: ",l.telegram_id]})]})]})}),t.jsx("td",{className:"px-6 py-4",children:t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs(m,{className:"bg-zinc-100 font-bold text-zinc-700 shadow-none ring-1 ring-zinc-200",children:[l.orders_count," Orders"]})})}),t.jsxs("td",{className:"px-6 py-4",children:[t.jsx("p",{className:"font-black text-[#212121]",children:bt(l.total_spent)}),l.last_order_at&&t.jsxs("p",{className:"text-[10px] font-medium text-zinc-400",children:["Last: ",l.last_order_at]})]}),t.jsx("td",{className:"px-6 py-4 text-right",children:t.jsx(K,{variant:"ghost",size:"sm",asChild:!0,className:"h-8 rounded-lg font-bold text-[#F57C00] hover:bg-[#F57C00]/10",children:t.jsx(ft,{href:`/staff/customers?search=${encodeURIComponent(o.data.search??"")}&customer_id=${l.id}`,preserveState:!0,preserveScroll:!0,children:"View History"})})})]},l.id),e[76]=o.data.search,e[77]=c,e[78]=r):r=e[78],F=i.data.map(r),e[72]=i.data,e[73]=o.data.search,e[74]=c,e[75]=F}else F=e[75];let T;e[79]!==F?(T=t.jsx("tbody",{children:F}),e[79]=F,e[80]=T):T=e[80];let D;e[81]!==E||e[82]!==T?(D=t.jsx(J,{className:"p-0",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-left",children:[E,T]})})}),e[81]=E,e[82]=T,e[83]=D):D=e[83];let we;e[84]!==C||e[85]!==D?(we=t.jsxs(Q,{className:"overflow-hidden border-none shadow-md ring-1 ring-zinc-200",children:[C,D]}),e[84]=C,e[85]=D,e[86]=we):we=e[86];let ze;e[87]===Symbol.for("react.memo_cache_sentinel")?(ze=t.jsx(at,{className:"border-b border-zinc-100 bg-zinc-50/50 py-4",children:t.jsxs(rt,{className:"flex items-center gap-2 text-sm font-black uppercase tracking-widest text-[#212121]",children:[t.jsx(At,{className:"size-4 text-[#F57C00]"}),"Outreach & Promotions"]})}),e[87]=ze):ze=e[87];let ke;e[88]===Symbol.for("react.memo_cache_sentinel")?(ke=t.jsx(G,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Message Templates"}),e[88]=ke):ke=e[88];let L;e[89]!==p.length?(L=t.jsxs("div",{className:"flex items-center justify-between",children:[ke,t.jsx(m,{variant:"outline",className:"text-[10px] font-bold text-[#F57C00] border-[#F57C00]/30",children:p.length})]}),e[89]=p.length,e[90]=L):L=e[90];let M;e[91]!==s||e[92]!==p?(M=t.jsx("div",{className:"grid gap-2",children:p.length>0?t.jsx("div",{className:"flex flex-col gap-2",children:p.map(r=>t.jsxs("button",{type:"button",onClick:()=>s.setData("message",r.body),className:"flex flex-col rounded-xl border border-zinc-100 bg-zinc-50/50 p-3 text-left transition-all hover:border-[#F57C00]/30 hover:bg-white hover:shadow-sm",children:[t.jsx("span",{className:"text-xs font-black text-[#212121]",children:r.label}),t.jsx("span",{className:"mt-1 line-clamp-1 text-[10px] text-zinc-500",children:r.body})]},r.key))}):t.jsx("div",{className:"rounded-xl border border-dashed border-zinc-200 py-6 text-center",children:t.jsx("p",{className:"text-[10px] font-bold text-zinc-400",children:"No templates defined"})})}),e[91]=s,e[92]=p,e[93]=M):M=e[93];let Ce;e[94]!==L||e[95]!==M?(Ce=t.jsxs("div",{className:"lg:col-span-4 space-y-4",children:[L,M]}),e[94]=L,e[95]=M,e[96]=Ce):Ce=e[96];let Se;e[97]===Symbol.for("react.memo_cache_sentinel")?(Se=t.jsx(G,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Delivery Channel"}),e[97]=Se):Se=e[97];const Qe=`rounded-lg px-4 py-1.5 text-xs font-black transition-colors ${s.data.platform==="sms"?"bg-[#212121] text-white":"text-zinc-600 hover:bg-zinc-50"}`;let $;e[98]!==s?($=()=>{s.setData("platform","sms"),s.setData("telegram_button_text",""),s.setData("telegram_button_url","")},e[98]=s,e[99]=$):$=e[99];let I;e[100]!==Qe||e[101]!==$?(I=t.jsx("button",{type:"button",className:Qe,onClick:$,children:"SMS"}),e[100]=Qe,e[101]=$,e[102]=I):I=e[102];const Je=`rounded-lg px-4 py-1.5 text-xs font-black transition-colors ${s.data.platform==="telegram"?"bg-[#212121] text-white":"text-zinc-600 hover:bg-zinc-50"}`;let P;e[103]!==s?(P=()=>s.setData("platform","telegram"),e[103]=s,e[104]=P):P=e[104];let R;e[105]!==Je||e[106]!==P?(R=t.jsx("button",{type:"button",className:Je,onClick:P,children:"Telegram"}),e[105]=Je,e[106]=P,e[107]=R):R=e[107];let Ee;e[108]!==I||e[109]!==R?(Ee=t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[Se,t.jsxs("div",{className:"inline-flex rounded-xl border border-zinc-200 bg-white p-1",children:[I,R]})]}),e[108]=I,e[109]=R,e[110]=Ee):Ee=e[110];let Fe;e[111]===Symbol.for("react.memo_cache_sentinel")?(Fe=t.jsx(G,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Compose Message"}),e[111]=Fe):Fe=e[111];const Ke=`text-[10px] font-black tracking-widest ${s.data.message.length>Math.floor(h*.85)?"text-rose-500":"text-zinc-400"}`;let Te;e[112]!==h||e[113]!==s.data.message.length||e[114]!==Ke?(Te=t.jsxs("div",{className:"flex items-center justify-between",children:[Fe,t.jsxs("span",{className:Ke,children:[s.data.message.length,"/",h," Characters"]})]}),e[112]=h,e[113]=s.data.message.length,e[114]=Ke,e[115]=Te):Te=e[115];let De;e[116]!==s?(De=r=>s.setData("message",r.target.value),e[116]=s,e[117]=De):De=e[117];let Le;e[118]!==c.length?(Le=t.jsx("div",{className:"absolute bottom-4 right-4 flex h-10 w-10 items-center justify-center rounded-full bg-zinc-50 text-[10px] font-black text-zinc-400 ring-1 ring-zinc-200",children:c.length}),e[118]=c.length,e[119]=Le):Le=e[119];let Me;e[120]!==g||e[121]!==x||e[122]!==s?(Me=x&&t.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(G,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"telegram_button_text",children:"Inline Button Text"}),t.jsx(lt,{id:"telegram_button_text",className:"h-11 rounded-xl border-zinc-200 focus:ring-[#F57C00]",value:s.data.telegram_button_text,maxLength:64,onChange:r=>s.setData("telegram_button_text",r.target.value),placeholder:"Open Offer"})]}),t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(G,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"telegram_button_url",children:"Inline Button URL"}),t.jsx(lt,{id:"telegram_button_url",type:"url",className:"h-11 rounded-xl border-zinc-200 focus:ring-[#F57C00]",value:s.data.telegram_button_url,onChange:r=>s.setData("telegram_button_url",r.target.value),placeholder:"https://example.com/promo"})]}),t.jsx("p",{className:`text-[10px] font-bold uppercase tracking-widest md:col-span-2 ${g?"text-rose-500":"text-zinc-400"}`,children:g?"Provide both button text and URL, or leave both empty.":"If provided, Telegram recipients will receive a primary inline button."})]}),e[120]=g,e[121]=x,e[122]=s,e[123]=Me):Me=e[123];let $e;e[124]!==s.errors.message||e[125]!==s.errors.telegram_button_text||e[126]!==s.errors.telegram_button_url?($e=(s.errors.message||s.errors.telegram_button_text||s.errors.telegram_button_url)&&t.jsxs("div",{className:"space-y-1 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2",children:[s.errors.message?t.jsx("p",{className:"text-[11px] font-bold text-rose-700",children:s.errors.message}):null,s.errors.telegram_button_text?t.jsx("p",{className:"text-[11px] font-bold text-rose-700",children:s.errors.telegram_button_text}):null,s.errors.telegram_button_url?t.jsx("p",{className:"text-[11px] font-bold text-rose-700",children:s.errors.telegram_button_url}):null]}),e[124]=s.errors.message,e[125]=s.errors.telegram_button_text,e[126]=s.errors.telegram_button_url,e[127]=$e):$e=e[127];const vt="flex flex-wrap items-start justify-between gap-4",wt="flex-1 space-y-1",Xe=nt.length>0&&t.jsx("div",{className:"flex flex-wrap gap-1.5",children:nt.map(r=>t.jsx(m,{asChild:!0,variant:"outline",className:"rounded-lg border-zinc-200 bg-white px-0 py-0 text-[9px] font-bold text-zinc-500",children:t.jsx("button",{type:"button",className:"rounded-lg px-2 py-0.5 transition-colors hover:bg-zinc-50 hover:text-[#F57C00]",title:r.description,onClick:()=>yt(r.token),children:`{${r.token}}`})},r.token))});let Ie;e[128]===Symbol.for("react.memo_cache_sentinel")?(Ie=t.jsx("p",{className:"text-[9px] font-bold text-zinc-400 uppercase tracking-tighter",children:"Click to use placeholders in your message"}),e[128]=Ie):Ie=e[128];let O;e[129]!==Xe?(O=t.jsxs("div",{className:wt,children:[Xe,Ie]}),e[129]=Xe,e[130]=O):O=e[130];let B;e[131]!==g||e[132]!==c.length||e[133]!==s.data.message||e[134]!==s.processing?(B=s.processing||c.length===0||s.data.message.trim()===""||g,e[131]=g,e[132]=c.length,e[133]=s.data.message,e[134]=s.processing,e[135]=B):B=e[135];const Ye=s.processing?"Delivering...":`Send ${x?"Telegram":"SMS"} to ${c.length} Recipients`;let A;e[136]!==B||e[137]!==Ye?(A=t.jsx(K,{type:"submit",disabled:B,className:"h-12 px-10 rounded-xl bg-[#212121] font-black shadow-lg shadow-zinc-200 hover:bg-[#F57C00] transition-colors",children:Ye}),e[136]=B,e[137]=Ye,e[138]=A):A=e[138];let Pe;e[139]!==O||e[140]!==A?(Pe=t.jsxs("div",{className:vt,children:[O,A]}),e[139]=O,e[140]=A,e[141]=Pe):Pe=e[141];const Ze=!!n;let H;e[142]!==Ge?(H=r=>{r||Ge()},e[142]=Ge,e[143]=H):H=e[143];let U;e[144]!==n?(U=n?t.jsxs(Et,{className:"max-h-[92vh] overflow-y-auto border-none p-0 sm:max-w-6xl",children:[t.jsxs(Ft,{className:"sr-only",children:[t.jsx(Tt,{children:"Customer History"}),t.jsx(Dt,{children:"Detailed order history, source channels, top branch, and ordering habits."})]}),t.jsx("div",{className:"border-b border-zinc-100 bg-[#212121] px-6 py-6 text-white md:px-8",children:t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.3em] opacity-40",children:"Client Dossier"}),t.jsx("h3",{className:"mt-2 text-2xl font-black",children:n.name}),t.jsx("p",{className:"mt-1 font-bold text-[#F57C00] opacity-80",children:n.phone}),n.telegram_username&&t.jsxs("p",{className:"mt-1 text-xs font-semibold text-sky-200",children:["@",n.telegram_username]}),n.telegram_id&&t.jsxs("p",{className:"mt-1 text-[11px] font-semibold text-zinc-300",children:["TG ID: ",n.telegram_id]})]}),t.jsx("div",{className:"text-right",children:t.jsxs(m,{className:"border border-white/20 bg-white/10 font-black uppercase tracking-widest text-white shadow-none backdrop-blur-md",children:[n.source_summary.total," Total Orders"]})})]})}),t.jsxs("div",{className:"space-y-6 p-4 md:p-8",children:[t.jsxs("div",{className:"grid gap-4 lg:grid-cols-4",children:[t.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[t.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Source Mix"}),t.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[t.jsxs(m,{className:"bg-zinc-100 text-zinc-700 ring-1 ring-zinc-200 shadow-none",children:["Web ",n.source_summary.web]}),t.jsxs(m,{className:"bg-sky-50 text-sky-700 ring-1 ring-sky-200 shadow-none",children:["Telegram ",n.source_summary.telegram]}),t.jsxs(m,{className:"bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200 shadow-none",children:["Table ",n.source_summary.table]})]})]}),t.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[t.jsxs("p",{className:"flex items-center gap-1.5 text-[10px] font-black uppercase tracking-widest text-zinc-400",children:[t.jsx($t,{className:"size-3.5"}),"Frequent Time"]}),t.jsx("div",{className:"mt-3 space-y-1.5",children:n.top_order_hours.length>0?n.top_order_hours.map(Xt):t.jsx("p",{className:"text-xs font-semibold text-zinc-400",children:"No ordering pattern yet"})}),n.top_order_weekdays.length>0&&t.jsx("div",{className:"mt-3 flex flex-wrap gap-1.5",children:n.top_order_weekdays.map(Kt)})]}),t.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[t.jsxs("p",{className:"flex items-center gap-1.5 text-[10px] font-black uppercase tracking-widest text-zinc-400",children:[t.jsx(It,{className:"size-3.5"}),"Top Branch"]}),t.jsx("p",{className:"mt-3 text-sm font-black text-[#212121]",children:n.top_branch?.pickup_location??"N/A"}),n.top_branch&&t.jsxs("p",{className:"text-xs font-semibold text-zinc-500",children:[n.top_branch.orders_count," order(s)"]}),n.branch_summary.length>1&&t.jsx("div",{className:"mt-3 space-y-1",children:n.branch_summary.slice(1).map(Jt)})]}),t.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[t.jsxs("p",{className:"flex items-center gap-1.5 text-[10px] font-black uppercase tracking-widest text-zinc-400",children:[t.jsx(Pt,{className:"size-3.5"}),"Most Ordered"]}),t.jsx("div",{className:"mt-3 space-y-1.5",children:n.top_items.length>0?n.top_items.slice(0,4).map(Qt):t.jsx("p",{className:"text-xs font-semibold text-zinc-400",children:"No items yet"})})]})]}),t.jsxs("div",{children:[t.jsxs("p",{className:"mb-3 flex items-center gap-2 text-[10px] font-black uppercase tracking-widest text-zinc-400",children:[t.jsx(Rt,{className:"size-3.5"}),"Recent Orders (20)"]}),n.orders.length===0?t.jsx("div",{className:"py-12 text-center",children:t.jsx("p",{className:"text-zinc-400 font-bold uppercase tracking-widest text-xs",children:"No order history found for this account"})}):t.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:n.orders.map(Wt)})]})]})]}):null,e[144]=n,e[145]=U):U=e[145];let Re;e[146]!==Ze||e[147]!==H||e[148]!==U?(Re=t.jsx(Lt,{open:Ze,onOpenChange:H,children:U}),e[146]=Ze,e[147]=H,e[148]=U,e[149]=Re):Re=e[149];const et=i.from??0,tt=i.to??0;let q;e[150]!==i.total||e[151]!==et||e[152]!==tt?(q=t.jsxs("p",{className:"text-muted-foreground text-sm",children:["Showing ",et," to ",tt," of ",i.total," customer(s)"]}),e[150]=i.total,e[151]=et,e[152]=tt,e[153]=q):q=e[153];let V;e[154]!==i.links?(V=i.links.map(Vt),e[154]=i.links,e[155]=V):V=e[155];let W;e[156]!==V?(W=t.jsx("div",{className:"flex items-center gap-2",children:V}),e[156]=V,e[157]=W):W=e[157];let Oe;return e[158]!==q||e[159]!==W?(Oe=t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[q,W]}),e[158]=q,e[159]=W,e[160]=Oe):Oe=e[160],t.jsxs(Mt,{breadcrumbs:Ht,children:[ce,t.jsxs("div",{className:"space-y-8 bg-zinc-50/50 p-6 min-h-screen",children:[xe,be,we,t.jsxs(Q,{className:"border-none shadow-lg ring-1 ring-zinc-200",children:[ze,t.jsx(J,{className:"pt-6",children:t.jsxs("form",{className:"grid gap-8 lg:grid-cols-12",onSubmit:_t,children:[Ce,t.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[Ee,Te,t.jsxs("div",{className:"relative",children:[t.jsx("textarea",{id:"message",ref:ct,className:"min-h-[160px] w-full rounded-2xl border border-zinc-200 bg-white p-4 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-[#F57C00]/20 transition-all placeholder:text-zinc-300",value:s.data.message,maxLength:h,onChange:De,placeholder:x?"Enter your Telegram outreach message. Optional inline button fields are below.":"Enter your promotional or notification SMS here..."}),Le]}),Me,$e,Pe]})]})})]}),Re,Oe]})]})}function Vt(a){return t.jsx(K,{variant:a.active?"default":"outline",size:"sm",disabled:!a.url,asChild:!!a.url,className:`h-11 rounded-xl px-4 font-bold transition-all ${a.active?"bg-[#F57C00] text-white shadow-lg shadow-[#F57C00]/20":"text-zinc-500 border-zinc-200"}`,children:a.url?t.jsx(ft,{href:a.url,preserveState:!0,preserveScroll:!0,children:a.label.includes("Previous")?t.jsx(ut,{className:"size-4"}):a.label.includes("Next")?t.jsx(ht,{className:"size-4"}):t.jsx("span",{dangerouslySetInnerHTML:{__html:a.label}})}):t.jsx("span",{children:a.label.includes("Previous")?t.jsx(ut,{className:"size-4"}):a.label.includes("Next")?t.jsx(ht,{className:"size-4"}):t.jsx("span",{dangerouslySetInnerHTML:{__html:a.label}})})},a.label)}function Wt(a){return t.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-zinc-100 bg-zinc-50/50 p-5 transition-all hover:bg-white hover:shadow-md hover:ring-1 hover:ring-[#F57C00]/20",children:[t.jsxs("div",{className:"flex items-center justify-between gap-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Order Ref"}),t.jsxs("p",{className:"text-sm font-black text-[#212121]",children:["#",a.id]})]}),t.jsx("p",{className:"text-lg font-black text-[#F57C00]",children:bt(a.total_amount)})]}),t.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[t.jsx(m,{className:`rounded-lg px-2 py-0.5 text-[9px] font-black uppercase tracking-widest shadow-none ${qt(a.source_channel)}`,children:Ut(a.source_channel)}),t.jsx(m,{className:"rounded-lg bg-white px-2 py-0.5 text-[9px] font-black uppercase tracking-widest text-zinc-500 ring-1 ring-zinc-200 shadow-none",children:a.order_status}),t.jsxs(m,{className:"rounded-lg bg-white px-2 py-0.5 text-[9px] font-black uppercase tracking-widest text-[#F57C00] ring-1 ring-[#F57C00]/20 shadow-none",children:["Receipt ",a.receipt_status]})]}),t.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-zinc-400",children:"Location"}),t.jsx("p",{className:"truncate text-[11px] font-bold text-zinc-600",children:a.pickup_location??"N/A"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-zinc-400",children:"Date"}),t.jsx("p",{className:"text-[11px] font-bold text-zinc-600",children:a.pickup_date??"N/A"})]})]}),a.table_name&&t.jsxs("p",{className:"mt-2 text-[10px] font-semibold text-emerald-700",children:["Table: ",a.table_name]}),t.jsxs("div",{className:"mt-3",children:[t.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-zinc-400",children:"Items"}),a.items.length>0?t.jsx("div",{className:"mt-1.5 flex flex-wrap gap-1.5",children:a.items.map(Gt)}):t.jsx("p",{className:"mt-1 text-[11px] font-semibold text-zinc-400",children:"No item details"})]})]},a.id)}function Gt(a){return t.jsxs(m,{className:"bg-white text-zinc-600 ring-1 ring-zinc-200 shadow-none",children:[a.quantity,"x ",a.name??"Unknown"]},a.id)}function Qt(a){return t.jsxs("p",{className:"text-xs font-semibold text-zinc-700",children:[a.name," ",t.jsxs("span",{className:"text-zinc-400",children:["x",a.quantity]})]},a.name)}function Jt(a){return t.jsxs("p",{className:"text-xs font-medium text-zinc-500",children:[a.pickup_location,": ",a.orders_count]},a.pickup_location)}function Kt(a){return t.jsxs(m,{className:"bg-zinc-100 text-zinc-600 ring-1 ring-zinc-200 shadow-none",children:[a.weekday," ",a.orders_count]},a.weekday)}function Xt(a){return t.jsxs("p",{className:"text-xs font-semibold text-zinc-700",children:[a.label," ",t.jsxs("span",{className:"text-zinc-400",children:["(",a.orders_count,")"]})]},a.hour)}function Yt(){return Ae.get("/staff/customers")}function Zt(a){return a.id}export{js as default};
