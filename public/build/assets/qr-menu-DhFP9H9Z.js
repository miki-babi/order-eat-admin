import{c as Ue,r as ge,u as Ve,j as t,H as Ye,L as Ge}from"./app-D84iCcti.js";import{I as Ae}from"./input-error-Bb3X9jEa.js";import{B as Ke}from"./badge-BAZr7H_9.js";import{B as je}from"./createLucideIcon-Zg2zAzDP.js";import{I as We}from"./input-BUu8zD-q.js";import{C as Xe}from"./circle-check-BVEd2mup.js";import{Q as Ze,S as et}from"./store-Bf54E-uk.js";import{S as tt}from"./shopping-cart-ClwvivUO.js";import{T as st}from"./table-2-vRYfNVed.js";import{S as lt}from"./search-NuDpLW0D.js";/* empty css            */function Ee(s){return new Intl.NumberFormat("en-ET",{style:"currency",currency:"ETB",maximumFractionDigits:2}).format(s)}function Pe(s,e){if(!s||typeof s!="object"||Array.isArray(s))return{};const c={};return Object.entries(s).forEach(([K,u])=>{const n=Number(K),i=typeof u=="number"?u:Number(u);!Number.isInteger(n)||n<1||!e.has(n)||!Number.isInteger(i)||i<1||i>100||(c[n]=i)}),c}function nt(s,e){if(typeof window>"u")return{};try{const c=window.localStorage.getItem(s);return c?Pe(JSON.parse(c),e):{}}catch{return{}}}function it(s,e){if(!(typeof window>"u"))try{if(Object.keys(e).length===0){window.localStorage.removeItem(s);return}window.localStorage.setItem(s,JSON.stringify(e))}catch{}}function rt(s){if(!(typeof window>"u"))try{window.localStorage.removeItem(s)}catch{}}function Ct(s){const e=Ue.c(131),{menuItems:c,categories:K,customerToken:u,table:n,tableSession:i,filters:qe,staffRoute:W}=s,x=`kds:customer:qr-cart:${n.qr_code}:${u}`;let X;e[0]!==c?(X=new Set(c.map(ut)),e[0]=c,e[1]=X):X=e[1];const h=X,[p,Be]=ge.useState(qe.search??""),[o,Te]=ge.useState(qe.category??"all");let Z;e[2]!==h||e[3]!==x?(Z=()=>nt(x,h),e[2]=h,e[3]=x,e[4]=Z):Z=e[4];const[a,Oe]=ge.useState(Z);let ee;e[5]!==u||e[6]!==i.token?(ee={customer_token:u,table_session_token:i.token},e[5]=u,e[6]=i.token,e[7]=ee):ee=e[7];const d=Ve(ee);let te;e[8]!==c?(te=c.reduce(xt,{}),e[8]=c,e[9]=te):te=e[9];const Ne=te;let se;if(e[10]!==o||e[11]!==c||e[12]!==p){let l;e[14]!==o||e[15]!==p?(l=r=>{const b=o==="all"||(r.category??"Uncategorized")===o,f=p.toLowerCase(),Je=!f||r.name.toLowerCase().includes(f)||(r.description??"").toLowerCase().includes(f)||(r.category??"").toLowerCase().includes(f);return b&&Je},e[14]=o,e[15]=p,e[16]=l):l=e[16],se=c.filter(l),e[10]=o,e[11]=c,e[12]=p,e[13]=se}else se=e[13];const le=se;let g;e[17]!==a?(g=Object.entries(a),e[17]=a,e[18]=g):g=e[18];let ne;e[19]!==Ne||e[20]!==g?(ne=g.map(l=>{const[r,b]=l,f=Ne[Number(r)];return!f||b<1?null:{...f,quantity:b,lineTotal:f.price*b}}).filter(ft),e[19]=Ne,e[20]=g,e[21]=ne):ne=e[21];const m=ne;let ie;e[22]!==m?(ie=m.reduce(mt,0),e[22]=m,e[23]=ie):ie=e[23];const ye=ie,Re=m.reduce(dt,0);let re,ce;e[24]!==h||e[25]!==a||e[26]!==x?(ce=()=>{it(x,Pe(a,h))},re=[a,x,h],e[24]=h,e[25]=a,e[26]=x,e[27]=re,e[28]=ce):(re=e[27],ce=e[28]),ge.useEffect(ce,re);let ae;e[29]===Symbol.for("react.memo_cache_sentinel")?(ae=(l,r)=>{Oe(b=>{const f={...b};return r<=0?delete f[l]:f[l]=r,f})},e[29]=ae):ae=e[29];const ve=ae;let oe;e[30]!==m||e[31]!==x||e[32]!==d||e[33]!==n.qr_code||e[34]!==i.token?(oe=()=>{const l=m.map(ot);d.transform(r=>({...r,items:l})),d.post(`/qr-menu/${n.qr_code}/orders?session=${encodeURIComponent(i.token)}`,{preserveScroll:!0,onSuccess:()=>{rt(x),Oe({})},onError:at})},e[30]=m,e[31]=x,e[32]=d,e[33]=n.qr_code,e[34]=i.token,e[35]=oe):oe=e[35];const we=oe,ke=`QR Menu • ${n.name}`;let j;e[36]!==ke?(j=t.jsx(Ye,{title:ke}),e[36]=ke,e[37]=j):j=e[37];const Le="min-h-screen bg-[#FAFAFA] text-[#212121]",$e="mx-auto w-full max-w-7xl px-4 py-8 md:px-8";let de;e[38]===Symbol.for("react.memo_cache_sentinel")?(de=t.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Table QR Order"}),e[38]=de):de=e[38];let me;e[39]===Symbol.for("react.memo_cache_sentinel")?(me=t.jsx(st,{className:"size-6 text-[#F57C00]"}),e[39]=me):me=e[39];let N;e[40]!==n.name?(N=t.jsxs("h1",{className:"mt-2 flex items-center gap-2 text-2xl font-black text-[#212121]",children:[me,n.name]}),e[40]=n.name,e[41]=N):N=e[41];let y;e[42]!==n.pickup_location.address||e[43]!==n.pickup_location.name?(y=t.jsxs("p",{className:"mt-1 text-sm font-medium text-zinc-500",children:[n.pickup_location.name," • ",n.pickup_location.address]}),e[42]=n.pickup_location.address,e[43]=n.pickup_location.name,e[44]=y):y=e[44];let v;e[45]!==N||e[46]!==y?(v=t.jsxs("div",{children:[de,N,y]}),e[45]=N,e[46]=y,e[47]=v):v=e[47];const ze=i.is_verified?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700";let w;e[48]!==i.is_verified?(w=i.is_verified?t.jsxs(t.Fragment,{children:[t.jsx(Xe,{className:"mr-1 size-3"}),"Session Verified"]}):t.jsxs(t.Fragment,{children:[t.jsx(Ze,{className:"mr-1 size-3"}),"Session Pending Verify"]}),e[48]=i.is_verified,e[49]=w):w=e[49];let k;e[50]!==ze||e[51]!==w?(k=t.jsx(Ke,{className:ze,children:w}),e[50]=ze,e[51]=w,e[52]=k):k=e[52];let z;e[53]!==i.token?(z=i.token.slice(0,16),e[53]=i.token,e[54]=z):z=e[54];let C;e[55]!==z?(C=t.jsxs("p",{className:"text-[11px] font-mono text-zinc-400",children:[z,"..."]}),e[55]=z,e[56]=C):C=e[56];let _;e[57]!==W?(_=W?t.jsx(Ge,{href:W,className:"text-xs font-bold text-[#F57C00] hover:underline",children:"Staff Dashboard"}):null,e[57]=W,e[58]=_):_=e[58];let S;e[59]!==k||e[60]!==C||e[61]!==_?(S=t.jsxs("div",{className:"flex flex-col items-end gap-2",children:[k,C,_]}),e[59]=k,e[60]=C,e[61]=_,e[62]=S):S=e[62];let F;e[63]!==v||e[64]!==S?(F=t.jsx("div",{className:"mb-8 rounded-3xl bg-white p-6 shadow-sm ring-1 ring-zinc-200",children:t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[v,S]})}),e[63]=v,e[64]=S,e[65]=F):F=e[65];const Me="grid gap-8 lg:grid-cols-[1fr_360px]";let fe;e[66]===Symbol.for("react.memo_cache_sentinel")?(fe=t.jsx(lt,{className:"absolute top-1/2 left-4 size-4 -translate-y-1/2 text-zinc-400"}),e[66]=fe):fe=e[66];let xe;e[67]===Symbol.for("react.memo_cache_sentinel")?(xe=l=>Be(l.target.value),e[67]=xe):xe=e[67];let I;e[68]!==p?(I=t.jsxs("div",{className:"relative",children:[fe,t.jsx(We,{className:"h-12 rounded-2xl border-zinc-200 pl-10 focus:ring-[#F57C00]",value:p,onChange:xe,placeholder:"Search menu items"})]}),e[68]=p,e[69]=I):I=e[69];const Ce=o==="all"?"bg-[#F57C00] hover:bg-[#E65100]":"",_e=o==="all"?"default":"outline";let ue;e[70]===Symbol.for("react.memo_cache_sentinel")?(ue=()=>Te("all"),e[70]=ue):ue=e[70];let E;e[71]!==Ce||e[72]!==_e?(E=t.jsx(je,{type:"button",size:"sm",className:Ce,variant:_e,onClick:ue,children:"All"}),e[71]=Ce,e[72]=_e,e[73]=E):E=e[73];let q;if(e[74]!==o||e[75]!==K){let l;e[77]!==o?(l=r=>t.jsx(je,{type:"button",size:"sm",className:o===r?"bg-[#F57C00] hover:bg-[#E65100]":"",variant:o===r?"default":"outline",onClick:()=>Te(r),children:r},r),e[77]=o,e[78]=l):l=e[78],q=K.map(l),e[74]=o,e[75]=K,e[76]=q}else q=e[76];let T;e[79]!==E||e[80]!==q?(T=t.jsxs("div",{className:"flex flex-wrap gap-2",children:[E,q]}),e[79]=E,e[80]=q,e[81]=T):T=e[81];let O;e[82]!==I||e[83]!==T?(O=t.jsxs("div",{className:"space-y-4",children:[I,T]}),e[82]=I,e[83]=T,e[84]=O):O=e[84];let A;e[85]!==a||e[86]!==le?(A=le.length===0?t.jsx("div",{className:"rounded-2xl bg-white p-10 text-center ring-1 ring-zinc-200",children:t.jsx("p",{className:"text-sm font-bold text-zinc-500",children:"No items found for this search."})}):t.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:le.map(l=>t.jsxs("div",{className:"overflow-hidden rounded-2xl bg-white shadow-sm ring-1 ring-zinc-200",children:[t.jsx("div",{className:"aspect-[4/3] bg-zinc-100",children:l.image_url?t.jsx("img",{src:l.image_url,alt:l.name,className:"h-full w-full object-cover",loading:"lazy"}):t.jsx("div",{className:"flex h-full w-full items-center justify-center text-zinc-400",children:t.jsx(tt,{className:"size-8"})})}),t.jsxs("div",{className:"space-y-3 p-4",children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-black text-zinc-900",children:l.name}),t.jsx("p",{className:"text-sm text-zinc-500",children:l.description??"Freshly prepared for your table."})]}),t.jsx("p",{className:"text-sm font-black text-[#F57C00]",children:Ee(l.price)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-zinc-50 p-1 ring-1 ring-zinc-200",children:[t.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-white text-sm font-black text-zinc-700 hover:bg-[#F57C00] hover:text-white",onClick:()=>ve(l.id,(a[l.id]??0)-1),children:"-"}),t.jsx("span",{className:"w-8 text-center text-sm font-black",children:a[l.id]??0}),t.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-white text-sm font-black text-zinc-700 hover:bg-[#F57C00] hover:text-white",onClick:()=>ve(l.id,(a[l.id]??0)+1),children:"+"})]}),t.jsx(je,{type:"button",size:"sm",className:(a[l.id]??0)>0?"bg-emerald-600 hover:bg-emerald-700":"bg-[#F57C00] hover:bg-[#E65100]",onClick:()=>ve(l.id,Math.max(1,(a[l.id]??0)+1)),children:(a[l.id]??0)>0?"Add more":"Add"})]})]})]},l.id))}),e[85]=a,e[86]=le,e[87]=A):A=e[87];let P;e[88]!==O||e[89]!==A?(P=t.jsxs("section",{className:"space-y-6",children:[O,A]}),e[88]=O,e[89]=A,e[90]=P):P=e[90];const Qe="sticky top-6 space-y-6",De="rounded-2xl bg-white p-5 shadow-sm ring-1 ring-zinc-200";let B;e[91]===Symbol.for("react.memo_cache_sentinel")?(B=t.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-zinc-500",children:"Your Table Order"}),e[91]=B):B=e[91];const He="mt-1 text-2xl font-black text-zinc-900",Se=Ee(Re);let R;e[92]!==Se?(R=t.jsx("p",{className:He,children:Se}),e[92]=Se,e[93]=R):R=e[93];let L;e[94]!==ye?(L=t.jsxs("p",{className:"mt-1 text-sm font-medium text-zinc-500",children:[ye," item(s)"]}),e[94]=ye,e[95]=L):L=e[95];let $;e[96]!==m?($=m.length===0?t.jsx("p",{className:"rounded-xl bg-zinc-50 p-3 text-sm font-medium text-zinc-500",children:"No items selected yet."}):m.map(ct),e[96]=m,e[97]=$):$=e[97];let M;e[98]!==$?(M=t.jsx("div",{className:"mt-4 space-y-2",children:$}),e[98]=$,e[99]=M):M=e[99];let Q;e[100]!==d.errors.items?(Q=t.jsx(Ae,{message:d.errors.items}),e[100]=d.errors.items,e[101]=Q):Q=e[101];let D;e[102]!==B||e[103]!==R||e[104]!==L||e[105]!==M||e[106]!==Q?(D=t.jsxs("div",{className:De,children:[B,R,L,M,Q]}),e[102]=B,e[103]=R,e[104]=L,e[105]=M,e[106]=Q,e[107]=D):D=e[107];let pe;e[108]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[t.jsx(et,{className:"size-4 text-[#F57C00]"}),t.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-zinc-500",children:"Place Order"})]}),e[108]=pe):pe=e[108];let he;e[109]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx("p",{className:"rounded-xl bg-zinc-50 px-3 py-3 text-xs font-medium text-zinc-600 ring-1 ring-zinc-200",children:"No contact details required for table QR orders."}),e[109]=he):he=e[109];let H;e[110]!==d.errors.table_session_token?(H=t.jsx(Ae,{message:d.errors.table_session_token}),e[110]=d.errors.table_session_token,e[111]=H):H=e[111];const Fe=d.processing||m.length===0,Ie=d.processing?"Placing Order...":"Place Table Order";let J;e[112]!==we||e[113]!==Fe||e[114]!==Ie?(J=t.jsx(je,{type:"button",className:"h-11 w-full rounded-xl bg-[#212121] font-black text-white hover:bg-black",disabled:Fe,onClick:we,children:Ie}),e[112]=we,e[113]=Fe,e[114]=Ie,e[115]=J):J=e[115];let U;e[116]!==H||e[117]!==J?(U=t.jsxs("div",{className:"rounded-2xl bg-white p-5 shadow-sm ring-1 ring-zinc-200",children:[pe,t.jsxs("div",{className:"space-y-4",children:[he,H,J]})]}),e[116]=H,e[117]=J,e[118]=U):U=e[118];let V;e[119]!==D||e[120]!==U?(V=t.jsx("aside",{children:t.jsxs("div",{className:Qe,children:[D,U]})}),e[119]=D,e[120]=U,e[121]=V):V=e[121];let Y;e[122]!==P||e[123]!==V?(Y=t.jsxs("div",{className:Me,children:[P,V]}),e[122]=P,e[123]=V,e[124]=Y):Y=e[124];let G;e[125]!==F||e[126]!==Y?(G=t.jsx("div",{className:Le,children:t.jsxs("main",{className:$e,children:[F,Y]})}),e[125]=F,e[126]=Y,e[127]=G):G=e[127];let be;return e[128]!==j||e[129]!==G?(be=t.jsxs(t.Fragment,{children:[j,G]}),e[128]=j,e[129]=G,e[130]=be):be=e[130],be}function ct(s){return t.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-zinc-50 px-3 py-2",children:[t.jsxs("span",{className:"truncate text-sm font-bold text-zinc-800",children:[s.name," x",s.quantity]}),t.jsx("span",{className:"text-sm font-black text-zinc-900",children:Ee(s.lineTotal)})]},s.id)}function at(s){s.table_session_token&&window.location.reload()}function ot(s){return{menu_item_id:s.id,quantity:s.quantity}}function dt(s,e){return s+e.lineTotal}function mt(s,e){return s+e.quantity}function ft(s){return!!s}function xt(s,e){return s[e.id]=e,s}function ut(s){return s.id}export{Ct as default};
