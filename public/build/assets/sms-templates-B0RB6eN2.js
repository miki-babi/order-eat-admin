import{u as vt,r as l,a as U,j as e,H as wt,b as Re}from"./app-B1ifENt7.js";import{I as F}from"./input-error-idKhxiu_.js";import{B as o}from"./badge-BxHkdwaA.js";import{b as P,B as c}from"./createLucideIcon-DBjBHpes.js";import{d as h,C as g,a as w,b as k}from"./card-DUXOF7wf.js";import{e as se,d as ae,D as re,a as ne,b as le}from"./dialog-KhuxQ9ux.js";import{I as d}from"./input-ZZWHhI5M.js";import{L as i}from"./label-CvzI8C74.js";import{A as kt,d as yt,a as _t}from"./app-layout-BaTFaLhf.js";import{A as Oe}from"./arrow-right-uZ1Is74Z.js";import{S as zt}from"./smartphone-Btn1Vsc8.js";import{C as Ct}from"./circle-check-aPatD-Re.js";import{U as St}from"./users-ClLoEKCw.js";/* empty css            */import"./index-CFPRdl_O.js";import"./index-CmpwTNNW.js";import"./x-DG3YsQOQ.js";import"./index-D62cbb27.js";import"./index-BuAWgm97.js";import"./index-C8o9R0tm.js";import"./store-PGPmctu0.js";import"./map-pin-CMaCX4Sl.js";import"./chevron-right-BOcL-KTG.js";const Et=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Be=P("ArrowLeft",Et);const Ft=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Pt=P("CircleX",Ft);const At=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],qe=P("CloudUpload",At);const Lt=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Mt=P("LayoutGrid",Lt);const Tt=[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]],Dt=P("Megaphone",Tt);const $t=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]],Rt=P("MessageCircle",$t),Ot=[{title:"Communication",href:"/staff/sms-templates"}],W=["Start","Platform","Customers","Promo Message"],T=[{title:"Recover dormant customers",description:"Target people inactive for 30-120 days and re-engage them with a branch-specific offer.",outcome:"Higher reactivation rate"},{title:"Upsell frequent buyers",description:"Focus on high-frequency audiences and personalize message with frequent item + branch variables.",outcome:"Bigger average order value"},{title:"Launch branch-specific promos",description:"Pinpoint by branch and item behavior so each audience receives relevant campaign content.",outcome:"Stronger conversion quality"}],Bt={recent_item:"Uses the item from the customer most recent order. If that order has multiple items, it picks the most dominant one.",recent_branch:"Uses the pickup branch from the customer most recent order so your message can reference the latest location they used.",freq_item:"Uses the item the customer buys most frequently across order history, helping you recommend what they already prefer.",freq_branch:"Uses the branch the customer orders from most often, useful for location-specific promos and reminders."},qt=new Intl.NumberFormat("en-ET",{style:"currency",currency:"ETB",maximumFractionDigits:2});function ie(N){return qt.format(N)}function ms({templates:N,placeholders:V,notificationSettings:Ue,phoneLists:ce,summary:f,branches:H=[],menuItems:y=[]}){const{flash:D}=vt().props,[j,We]=l.useState(N[0]??null),[Ve,oe]=l.useState(null),[de,xe]=l.useState(null),[He,Ie]=l.useState(0),[Ge,I]=l.useState(!1),[u,A]=l.useState(0),[me,G]=l.useState(null),[Xe,_]=l.useState(!1),[$,L]=l.useState(null),[m,z]=l.useState(null),[pe,he]=l.useState(!1),[ge,C]=l.useState(null),[ue,R]=l.useState(0),[be,fe]=l.useState(!1),[S,Ke]=l.useState(null),je=l.useRef(null),Ne=l.useRef(null),n=U({label:N[0]?.label??"",body:N[0]?.body??"",is_active:N[0]?.is_active??!0}),p=U({phone:"",list_type:"whitelist",note:""}),v=U({contacts_file:null}),s=U({platform:"",search:"",orders_min:"",orders_max:"",recency_min_days:"",recency_max_days:"",total_spent_min:"",total_spent_max:"",avg_order_value_min:"",avg_order_value_max:"",branch_ids:[],include_menu_item_ids:[],exclude_menu_item_ids:[],message:"",telegram_button_text:"",telegram_button_url:"",save_template:!1,template_label:""}),X=ce.filter(t=>t.list_type==="whitelist"),K=ce.filter(t=>t.list_type==="blacklist"),O=s.data.platform==="sms"?480:2e3,Y=s.data.platform==="telegram"&&s.data.telegram_button_text.trim()===""!=(s.data.telegram_button_url.trim()===""),Ye=u===W.length-1,ve=H.filter(t=>s.data.branch_ids.includes(t.id)).map(t=>t.name),we=y.filter(t=>s.data.include_menu_item_ids.includes(t.id)).map(t=>t.name),ke=y.filter(t=>s.data.exclude_menu_item_ids.includes(t.id)).map(t=>t.name),J=T[ue],Je=S?Bt[S.token]??"This variable is replaced automatically with customer/order data when the campaign is sent.":"",ye=({token:t,textarea:a,currentValue:r,maxLength:x,updateValue:q})=>{const ee=`{${t}}`;if(!a){q(`${r}${ee}`.slice(0,x));return}const te=a.selectionStart??r.length,Nt=a.selectionEnd??te,Te=`${r.slice(0,te)}${ee}${r.slice(Nt)}`.slice(0,x);q(Te);const De=Math.min(te+ee.length,Te.length),$e=()=>{a.focus(),a.setSelectionRange(De,De)};if(typeof window<"u"){window.requestAnimationFrame($e);return}$e()},Ze=t=>{ye({token:t,textarea:je.current,currentValue:s.data.message,maxLength:O,updateValue:a=>s.setData("message",a)})},Qe=t=>{ye({token:t,textarea:Ne.current,currentValue:n.data.body,maxLength:480,updateValue:a=>n.setData("body",a)})};l.useEffect(()=>{if(be)return;const t=window.setInterval(()=>{R(a=>a===T.length-1?0:a+1)},3e3);return()=>{window.clearInterval(t)}},[be]);const _e=t=>{We(t),n.setData({label:t.label,body:t.body,is_active:t.is_active}),n.clearErrors()},et=t=>{t.preventDefault(),j&&n.put(`/staff/sms-templates/${j.id}`,{preserveScroll:!0,onSuccess:()=>{n.clearErrors()}})},tt=t=>{oe(t.id),Re.put(`/staff/sms-notification-settings/${t.id}`,{is_enabled:!t.is_enabled},{preserveState:!0,preserveScroll:!0,onFinish:()=>{oe(a=>a===t.id?null:a)}})},st=t=>{t.preventDefault(),p.post("/staff/sms-phone-lists",{preserveScroll:!0,onSuccess:()=>{p.reset("phone","note")}})},ze=t=>{xe(t),Re.delete(`/staff/sms-phone-lists/${t}`,{preserveState:!0,preserveScroll:!0,onFinish:()=>{xe(a=>a===t?null:a)}})},at=t=>{t.preventDefault(),v.post("/staff/sms-contacts/import",{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{v.reset("contacts_file"),Ie(a=>a+1)}})},Ce=()=>{z(null),C(null)},b=(t,a)=>{s.setData(t,a),Ce()},rt=()=>{s.reset(),s.clearErrors(),A(0),I(!0),_(!1),L(null),z(null),C(null)},Z=()=>{I(!1),A(0),_(!1),L(null),G(null)},nt=()=>{A(t=>Math.max(t-1,0))},lt=()=>{u===1&&s.data.platform===""||A(t=>Math.min(t+1,W.length-1))},Se=t=>{s.setData("platform",t),Ce(),t==="sms"&&s.data.message.length>480&&s.setData("message",s.data.message.slice(0,480)),t==="sms"&&(s.setData("telegram_button_text",""),s.setData("telegram_button_url",""))},it=t=>{const a=s.data.branch_ids.includes(t);b("branch_ids",a?s.data.branch_ids.filter(r=>r!==t):[...s.data.branch_ids,t])},ct=t=>{const a=s.data.include_menu_item_ids.includes(t);b("include_menu_item_ids",a?s.data.include_menu_item_ids.filter(r=>r!==t):[...s.data.include_menu_item_ids,t]),!a&&s.data.exclude_menu_item_ids.includes(t)&&s.setData("exclude_menu_item_ids",s.data.exclude_menu_item_ids.filter(r=>r!==t))},ot=t=>{const a=s.data.exclude_menu_item_ids.includes(t);b("exclude_menu_item_ids",a?s.data.exclude_menu_item_ids.filter(r=>r!==t):[...s.data.exclude_menu_item_ids,t]),!a&&s.data.include_menu_item_ids.includes(t)&&s.setData("include_menu_item_ids",s.data.include_menu_item_ids.filter(r=>r!==t))},dt=async()=>{if(!s.data.platform)return;const t=new URLSearchParams,a=(r,x)=>{x.trim()!==""&&t.append(r,x.trim())};t.set("platform",s.data.platform),a("search",s.data.search),a("orders_min",s.data.orders_min),a("orders_max",s.data.orders_max),a("recency_min_days",s.data.recency_min_days),a("recency_max_days",s.data.recency_max_days),a("total_spent_min",s.data.total_spent_min),a("total_spent_max",s.data.total_spent_max),a("avg_order_value_min",s.data.avg_order_value_min),a("avg_order_value_max",s.data.avg_order_value_max),s.data.branch_ids.forEach(r=>t.append("branch_ids[]",String(r))),s.data.include_menu_item_ids.forEach(r=>t.append("include_menu_item_ids[]",String(r))),s.data.exclude_menu_item_ids.forEach(r=>t.append("exclude_menu_item_ids[]",String(r))),he(!0),C(null);try{const r=await fetch(`/staff/sms-campaigns/preview-audience?${t.toString()}`,{method:"GET",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),x=await r.json();if(!r.ok){const q=typeof x=="object"&&x!==null&&"message"in x&&typeof x.message=="string"?x.message:"Unable to preview audience with the selected filters.";z(null),C(q);return}z(x)}catch{z(null),C("Unable to preview audience right now. Please try again.")}finally{he(!1)}},xt=s.data.orders_min||s.data.orders_max?`${s.data.orders_min||"0"} - ${s.data.orders_max||"Any"} orders`:"Any purchase frequency",mt=s.data.recency_min_days||s.data.recency_max_days?`${s.data.recency_min_days||"0"} to ${s.data.recency_max_days||"Any"} days since last order`:"Any recency window",pt=s.data.total_spent_min||s.data.total_spent_max?`${s.data.total_spent_min||"0"} to ${s.data.total_spent_max||"Any"} ETB total spend`:"Any total spend",ht=s.data.avg_order_value_min||s.data.avg_order_value_max?`${s.data.avg_order_value_min||"0"} to ${s.data.avg_order_value_max||"Any"} ETB average order value`:"Any average order value",gt=u===1?s.data.platform!=="":!0,M=s.data.platform!==""&&s.data.message.trim().length>0&&(m?.summary.matched_customers??0)>0&&!Y,E=m?.sample[0]??null,B=E?.preview_variables??{},ut=/\{recent_item\}/i.test(s.data.message)&&/\{freq_item\}/i.test(s.data.message),Q=B.recent_item?.trim()??"",Ee=B.freq_item?.trim()??"",bt=Q!==""&&Ee!==""&&Q.toLowerCase()===Ee.toLowerCase(),Fe=s.data.message.replace(/\{([a-z0-9_]+)\}/gi,(t,a)=>{const r=String(a).toLowerCase();return Object.prototype.hasOwnProperty.call(B,r)?B[r]??"":t}),Pe=$==="save_send",Ae=Pe?"Save Template + Send":"Send Promo",Le=t=>{!M||s.processing||(L(t),_(!0))},Me=()=>{s.processing||(_(!1),L(null))},ft=t=>{M&&(G(t?"save_send":"send"),s.transform(a=>({...a,save_template:t})),s.post("/staff/sms-campaigns/send",{preserveScroll:!0,onSuccess:()=>{s.reset(),s.clearErrors(),z(null),C(null),Z()},onError:()=>{A(3)},onFinish:()=>{G(null),s.transform(a=>({...a,save_template:!1}))}}))},jt=()=>{if($===null)return;const t=$==="save_send";_(!1),L(null),ft(t)};return e.jsxs(kt,{breadcrumbs:Ot,children:[e.jsx(wt,{title:"Outreach System"}),e.jsxs("div",{className:"space-y-8 bg-zinc-50/50 p-6 min-h-screen",children:[D?.success?e.jsx("div",{className:"rounded-2xl border-none bg-emerald-50 px-6 py-4 text-sm font-black text-emerald-800 shadow-sm ring-1 ring-emerald-200",children:D.success}):null,D?.error?e.jsx("div",{className:"rounded-2xl border-none bg-rose-50 px-6 py-4 text-sm font-black text-rose-800 shadow-sm ring-1 ring-rose-200",children:D.error}):null,e.jsxs("div",{className:"relative overflow-hidden rounded-3xl border border-zinc-200 bg-[#212121] shadow-xl",children:[e.jsx("div",{className:"pointer-events-none absolute -right-16 -top-20 h-64 w-64 rounded-full bg-[#F57C00]/25 blur-3xl"}),e.jsx("div",{className:"pointer-events-none absolute -left-20 bottom-0 h-40 w-40 rounded-full bg-white/10 blur-2xl"}),e.jsxs("div",{className:"grid gap-6 p-6 lg:grid-cols-[1.1fr_0.9fr] lg:p-8",children:[e.jsxs("div",{className:"space-y-5",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.25em] text-[#F57C00]",children:"Campaign Studio"}),e.jsx("h2",{className:"max-w-xl text-3xl font-black leading-tight text-white",children:"Build laser-targeted promo campaigns that feel personal for every customer."}),e.jsx("p",{className:"max-w-xl text-sm font-bold leading-relaxed text-zinc-300",children:"Use behavior filters, branch scope, and dynamic placeholders to turn mass outreach into high-conversion personalized campaigns."}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(o,{className:"rounded-lg bg-white/10 px-3 py-1 text-[10px] font-black uppercase tracking-widest text-white ring-1 ring-white/20",children:"Flow: Start"}),e.jsx(o,{className:"rounded-lg bg-white/10 px-3 py-1 text-[10px] font-black uppercase tracking-widest text-white ring-1 ring-white/20",children:"Platform"}),e.jsx(o,{className:"rounded-lg bg-white/10 px-3 py-1 text-[10px] font-black uppercase tracking-widest text-white ring-1 ring-white/20",children:"Targeting"}),e.jsx(o,{className:"rounded-lg bg-white/10 px-3 py-1 text-[10px] font-black uppercase tracking-widest text-white ring-1 ring-white/20",children:"Message"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 pt-1",children:[e.jsxs(c,{type:"button",className:"h-12 rounded-xl bg-[#F57C00] px-7 text-xs font-black uppercase tracking-widest shadow-lg shadow-[#F57C00]/30 hover:bg-[#E65100]",onClick:rt,children:[e.jsx(Dt,{className:"mr-2 size-4"}),"Launch Promo Wizard"]}),e.jsxs("p",{className:"text-[11px] font-black uppercase tracking-widest text-zinc-400",children:["Audience base: ",f.customers_count.toLocaleString()," customers"]})]})]}),e.jsxs("div",{className:"rounded-2xl border border-white/15 bg-white/5 p-4 backdrop-blur-sm",onMouseEnter:()=>fe(!0),onMouseLeave:()=>fe(!1),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-zinc-300",children:"Outcome Showcase"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{type:"button",size:"icon",variant:"ghost",className:"size-8 rounded-lg bg-white/10 text-white hover:bg-white/20",onClick:()=>R(t=>t===0?T.length-1:t-1),children:e.jsx(Be,{className:"size-4"})}),e.jsx(c,{type:"button",size:"icon",variant:"ghost",className:"size-8 rounded-lg bg-white/10 text-white hover:bg-white/20",onClick:()=>R(t=>t===T.length-1?0:t+1),children:e.jsx(Oe,{className:"size-4"})})]})]}),e.jsxs("div",{className:"mt-4 rounded-xl border-2 border-dashed border-white/20 bg-gradient-to-br from-white/10 to-white/0 p-5",children:[e.jsx("div",{className:"flex h-36 items-center justify-center rounded-lg border border-white/15 bg-black/20 text-center",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-zinc-300",children:"Carousel Image Slot"}),e.jsx("p",{className:"text-xs font-bold text-zinc-400",children:"Add final target-outcome screenshot here later."})]})}),e.jsx("h3",{className:"mt-4 text-base font-black text-white",children:J.title}),e.jsx("p",{className:"mt-1 text-xs font-bold leading-relaxed text-zinc-300",children:J.description}),e.jsxs("p",{className:"mt-3 text-[11px] font-black uppercase tracking-[0.18em] text-[#F57C00]",children:["Outcome: ",J.outcome]})]}),e.jsx("div",{className:"mt-3 flex items-center justify-center gap-1.5",children:T.map((t,a)=>e.jsx("button",{type:"button",className:`h-1.5 rounded-full transition-all ${a===ue?"w-7 bg-[#F57C00]":"w-3 bg-white/30 hover:bg-white/50"}`,onClick:()=>R(a),"aria-label":`Showcase slide ${a+1}`},t.title))})]})]})]}),e.jsx(se,{open:S!==null,onOpenChange:t=>{t||Ke(null)},children:e.jsxs(ae,{className:"border-none p-0 sm:max-w-xl",children:[e.jsxs(re,{className:"border-b border-zinc-100 bg-zinc-50/70 p-6",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#F57C00]",children:"SMS Variable Details"}),e.jsx(ne,{className:"mt-1 text-xl font-black text-[#212121]",children:S?`{${S.token}}`:"Variable"}),e.jsx(le,{className:"mt-2 text-xs font-bold leading-relaxed text-zinc-500",children:S?.description})]}),e.jsxs("div",{className:"space-y-4 p-6",children:[e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white p-4",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"What It Does"}),e.jsx("p",{className:"mt-2 text-sm font-bold leading-relaxed text-zinc-600",children:Je})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-zinc-50/60 p-4",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"How To Use"}),e.jsx("p",{className:"mt-2 text-xs font-bold leading-relaxed text-zinc-500",children:"Put this token directly in your SMS body. During send, the system replaces it with per-customer values. If no value exists for a customer, it resolves as empty text."})]})]})]})}),e.jsx(se,{open:Ge,onOpenChange:t=>{if(t){I(!0);return}Z()},children:e.jsxs(ae,{className:"max-h-[90vh] overflow-y-auto border-none p-0 sm:max-w-4xl",children:[e.jsxs(re,{className:"border-b border-zinc-100 bg-zinc-50/60 p-6",children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#F57C00]",children:"Promo Campaign Wizard"}),e.jsx(ne,{className:"mt-1 text-xl font-black text-[#212121]",children:"Build a targeted campaign"}),e.jsx(le,{className:"mt-1 text-xs font-bold text-zinc-500",children:"Flow: Start, choose platform, set customer filters, then write your platform-specific message."})]}),e.jsxs(o,{className:"rounded-lg bg-[#212121] px-3 py-1 text-[10px] font-black uppercase tracking-widest text-white",children:["Step ",u+1," / ",W.length]})]}),e.jsx("div",{className:"mt-5 grid gap-2 sm:grid-cols-4",children:W.map((t,a)=>{const r=a===u,x=a<u;return e.jsxs("div",{className:`rounded-xl px-3 py-2 text-left ring-1 transition-all ${r?"bg-[#212121] text-white ring-[#212121]":x?"bg-emerald-50 text-emerald-700 ring-emerald-200":"bg-white text-zinc-500 ring-zinc-200"}`,children:[e.jsxs("p",{className:"text-[9px] font-black uppercase tracking-widest",children:["Step ",a+1]}),e.jsx("p",{className:"mt-1 text-xs font-black",children:t})]},t)})})]}),e.jsxs("div",{className:"p-6",children:[u===0?e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-white p-5",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#F57C00]",children:"Start"}),e.jsx("h3",{className:"mt-2 text-lg font-black text-[#212121]",children:"Configure a high-conversion promo blast"}),e.jsx("p",{className:"mt-3 text-xs font-bold leading-relaxed text-zinc-500",children:"You will first select delivery platform, then define audience filters by purchase behavior and branch activity."})]}),e.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-zinc-50/50 p-5",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Wizard Flow"}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsx(o,{className:"bg-zinc-900 text-[10px] font-black uppercase tracking-widest text-white",children:"Start"}),e.jsx(o,{className:"bg-zinc-900 text-[10px] font-black uppercase tracking-widest text-white",children:"Platform"}),e.jsx(o,{className:"bg-zinc-900 text-[10px] font-black uppercase tracking-widest text-white",children:"Customers"}),e.jsx(o,{className:"bg-zinc-900 text-[10px] font-black uppercase tracking-widest text-white",children:"Promo Message"})]}),e.jsxs("p",{className:"mt-4 text-xs font-bold text-zinc-500",children:["Audience base available: ",f.customers_count.toLocaleString()," customers."]})]})]}):null,u===1?e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx("button",{type:"button",className:`rounded-2xl border p-5 text-left transition-all ${s.data.platform==="sms"?"border-[#F57C00] bg-[#F57C00]/5 shadow-sm":"border-zinc-200 bg-white hover:border-[#F57C00]/30"}`,onClick:()=>Se("sms"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-xl bg-zinc-900 p-2 text-white",children:e.jsx(zt,{className:"size-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-[#212121]",children:"SMS"}),e.jsx("p",{className:"text-[10px] font-bold text-zinc-500",children:"Fast text delivery, 480 char max."})]})]})}),e.jsx("button",{type:"button",className:`rounded-2xl border p-5 text-left transition-all ${s.data.platform==="telegram"?"border-[#F57C00] bg-[#F57C00]/5 shadow-sm":"border-zinc-200 bg-white hover:border-[#F57C00]/30"}`,onClick:()=>Se("telegram"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-xl bg-zinc-900 p-2 text-white",children:e.jsx(Rt,{className:"size-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-[#212121]",children:"Telegram"}),e.jsx("p",{className:"text-[10px] font-bold text-zinc-500",children:"Rich text style with longer copy limits."})]})]})})]}):null,u===2?e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex flex-wrap items-end justify-between gap-3 rounded-2xl border border-zinc-200 bg-zinc-50/50 p-4",children:[e.jsxs("div",{className:"grid w-full gap-2 sm:max-w-sm",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"promo-customer-search",children:"Customer Search"}),e.jsx(d,{id:"promo-customer-search",className:"h-11 rounded-xl border-zinc-200",value:s.data.search,onChange:t=>b("search",t.target.value),placeholder:"Name, phone, telegram username..."})]}),e.jsx(c,{type:"button",className:"h-11 rounded-xl bg-[#212121] px-6 font-black uppercase tracking-widest hover:bg-[#F57C00]",disabled:pe||!s.data.platform,onClick:dt,children:pe?"Previewing...":"Preview Audience"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[e.jsx("p",{className:"mb-3 text-[10px] font-black uppercase tracking-widest text-[#212121]",children:"Order Frequency"}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"promo-orders-min",children:"Min Orders"}),e.jsx(d,{id:"promo-orders-min",type:"number",min:0,className:"h-11 rounded-xl border-zinc-200",value:s.data.orders_min,onChange:t=>b("orders_min",t.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"promo-orders-max",children:"Max Orders"}),e.jsx(d,{id:"promo-orders-max",type:"number",min:0,className:"h-11 rounded-xl border-zinc-200",value:s.data.orders_max,onChange:t=>b("orders_max",t.target.value),placeholder:"No limit"})]})]})]}),e.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[e.jsx("p",{className:"mb-3 text-[10px] font-black uppercase tracking-widest text-[#212121]",children:"Recency Window (days)"}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"promo-recency-min",children:"Min Days Ago"}),e.jsx(d,{id:"promo-recency-min",type:"number",min:0,className:"h-11 rounded-xl border-zinc-200",value:s.data.recency_min_days,onChange:t=>b("recency_min_days",t.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"promo-recency-max",children:"Max Days Ago"}),e.jsx(d,{id:"promo-recency-max",type:"number",min:0,className:"h-11 rounded-xl border-zinc-200",value:s.data.recency_max_days,onChange:t=>b("recency_max_days",t.target.value),placeholder:"No limit"})]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[e.jsx("p",{className:"mb-3 text-[10px] font-black uppercase tracking-widest text-[#212121]",children:"Lifetime Spend (ETB)"}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"promo-total-min",children:"Min Total"}),e.jsx(d,{id:"promo-total-min",type:"number",min:0,className:"h-11 rounded-xl border-zinc-200",value:s.data.total_spent_min,onChange:t=>b("total_spent_min",t.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"promo-total-max",children:"Max Total"}),e.jsx(d,{id:"promo-total-max",type:"number",min:0,className:"h-11 rounded-xl border-zinc-200",value:s.data.total_spent_max,onChange:t=>b("total_spent_max",t.target.value),placeholder:"No limit"})]})]})]}),e.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[e.jsx("p",{className:"mb-3 text-[10px] font-black uppercase tracking-widest text-[#212121]",children:"Average Order Value (ETB)"}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"promo-avg-min",children:"Min AOV"}),e.jsx(d,{id:"promo-avg-min",type:"number",min:0,className:"h-11 rounded-xl border-zinc-200",value:s.data.avg_order_value_min,onChange:t=>b("avg_order_value_min",t.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"promo-avg-max",children:"Max AOV"}),e.jsx(d,{id:"promo-avg-max",type:"number",min:0,className:"h-11 rounded-xl border-zinc-200",value:s.data.avg_order_value_max,onChange:t=>b("avg_order_value_max",t.target.value),placeholder:"No limit"})]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#212121]",children:"Branch Filter"}),e.jsxs(o,{variant:"outline",className:"border-zinc-200 text-[10px] font-black text-zinc-500",children:[s.data.branch_ids.length," selected"]})]}),H.length>0?e.jsx("div",{className:"max-h-52 space-y-2 overflow-y-auto pr-1",children:H.map(t=>e.jsxs("label",{className:"flex cursor-pointer items-center gap-3 rounded-xl border border-zinc-100 bg-zinc-50/40 px-3 py-2",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-zinc-300 text-[#F57C00] focus:ring-[#F57C00]/20",checked:s.data.branch_ids.includes(t.id),onChange:()=>it(t.id)}),e.jsx("span",{className:"text-xs font-bold text-[#212121]",children:t.name})]},t.id))}):e.jsx("p",{className:"text-xs font-bold text-zinc-400",children:"No branches available yet."})]}),e.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#212121]",children:"Include Item Purchasers"}),e.jsx(o,{variant:"outline",className:"border-zinc-200 text-[10px] font-black text-zinc-500",children:s.data.include_menu_item_ids.length})]}),y.length>0?e.jsx("div",{className:"max-h-52 space-y-2 overflow-y-auto pr-1",children:y.map(t=>e.jsxs("label",{className:"flex cursor-pointer items-start gap-3 rounded-xl border border-zinc-100 bg-zinc-50/40 px-3 py-2",children:[e.jsx("input",{type:"checkbox",className:"mt-0.5 h-4 w-4 rounded border-zinc-300 text-[#F57C00] focus:ring-[#F57C00]/20",checked:s.data.include_menu_item_ids.includes(t.id),onChange:()=>ct(t.id)}),e.jsxs("span",{className:"leading-tight",children:[e.jsx("span",{className:"block text-xs font-bold text-[#212121]",children:t.name}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400",children:t.category??"Uncategorized"})]})]},t.id))}):e.jsx("p",{className:"text-xs font-bold text-zinc-400",children:"No menu items available yet."})]}),e.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#212121]",children:"Exclude Item Purchasers"}),e.jsx(o,{variant:"outline",className:"border-zinc-200 text-[10px] font-black text-zinc-500",children:s.data.exclude_menu_item_ids.length})]}),y.length>0?e.jsx("div",{className:"max-h-52 space-y-2 overflow-y-auto pr-1",children:y.map(t=>e.jsxs("label",{className:"flex cursor-pointer items-start gap-3 rounded-xl border border-zinc-100 bg-zinc-50/40 px-3 py-2",children:[e.jsx("input",{type:"checkbox",className:"mt-0.5 h-4 w-4 rounded border-zinc-300 text-[#F57C00] focus:ring-[#F57C00]/20",checked:s.data.exclude_menu_item_ids.includes(t.id),onChange:()=>ot(t.id)}),e.jsxs("span",{className:"leading-tight",children:[e.jsx("span",{className:"block text-xs font-bold text-[#212121]",children:t.name}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400",children:t.category??"Uncategorized"})]})]},t.id))}):e.jsx("p",{className:"text-xs font-bold text-zinc-400",children:"No menu items available yet."})]})]}),ge?e.jsx("div",{className:"rounded-2xl border-none bg-rose-50 px-4 py-3 text-xs font-black text-rose-700 ring-1 ring-rose-200",children:ge}):null,m?e.jsxs("div",{className:"space-y-4 rounded-2xl border border-zinc-200 bg-white p-4",children:[e.jsxs("div",{className:"grid gap-3 md:grid-cols-5",children:[e.jsxs("div",{className:"rounded-xl bg-zinc-50 p-3 ring-1 ring-zinc-200",children:[e.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-zinc-400",children:"Matched"}),e.jsx("p",{className:"mt-1 text-lg font-black text-[#212121]",children:m.summary.matched_customers.toLocaleString()})]}),e.jsxs("div",{className:"rounded-xl bg-zinc-50 p-3 ring-1 ring-zinc-200",children:[e.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-zinc-400",children:"High Value"}),e.jsx("p",{className:"mt-1 text-lg font-black text-[#212121]",children:m.summary.high_value_customers.toLocaleString()})]}),e.jsxs("div",{className:"rounded-xl bg-zinc-50 p-3 ring-1 ring-zinc-200",children:[e.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-zinc-400",children:"Dormant 90d+"}),e.jsx("p",{className:"mt-1 text-lg font-black text-[#212121]",children:m.summary.dormant_customers.toLocaleString()})]}),e.jsxs("div",{className:"rounded-xl bg-zinc-50 p-3 ring-1 ring-zinc-200",children:[e.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-zinc-400",children:"Avg Orders"}),e.jsx("p",{className:"mt-1 text-lg font-black text-[#212121]",children:m.summary.average_orders_per_customer.toFixed(1)})]}),e.jsxs("div",{className:"rounded-xl bg-zinc-50 p-3 ring-1 ring-zinc-200",children:[e.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-zinc-400",children:"Avg Spend"}),e.jsx("p",{className:"mt-1 text-lg font-black text-[#212121]",children:ie(m.summary.average_total_spent)})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-xl ring-1 ring-zinc-200",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-zinc-50/70",children:[e.jsx("th",{className:"px-3 py-2 text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Customer"}),e.jsx("th",{className:"px-3 py-2 text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Orders"}),e.jsx("th",{className:"px-3 py-2 text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Spent"}),e.jsx("th",{className:"px-3 py-2 text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"AOV"}),e.jsx("th",{className:"px-3 py-2 text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Recency"}),e.jsx("th",{className:"px-3 py-2 text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Telegram"})]})}),e.jsx("tbody",{children:m.sample.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-xs font-bold text-zinc-400",children:"No sample rows available for this audience."})}):m.sample.map(t=>e.jsxs("tr",{className:"border-t border-zinc-100",children:[e.jsxs("td",{className:"px-3 py-2",children:[e.jsx("p",{className:"text-xs font-black text-[#212121]",children:t.name}),e.jsx("p",{className:"text-[10px] font-bold text-zinc-500",children:t.phone})]}),e.jsx("td",{className:"px-3 py-2 text-xs font-black text-[#212121]",children:t.orders_count}),e.jsx("td",{className:"px-3 py-2 text-xs font-black text-[#212121]",children:ie(t.total_spent)}),e.jsx("td",{className:"px-3 py-2 text-xs font-black text-[#212121]",children:ie(t.average_order_value)}),e.jsx("td",{className:"px-3 py-2 text-xs font-black text-[#212121]",children:t.recency_days===null?"N/A":`${t.recency_days}d`}),e.jsx("td",{className:"px-3 py-2 text-xs font-black text-[#212121]",children:t.telegram_username?`@${t.telegram_username}`:"Not linked"})]},t.id))})]})})]}):null]}):null,u===3?e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-zinc-50/50 p-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#212121]",children:["Promo Message (",s.data.platform==="sms"?"SMS":"Telegram",")"]}),e.jsxs("span",{className:`text-[10px] font-black ${s.data.message.length>O*.9?"text-rose-500":"text-zinc-400"}`,children:[s.data.message.length,"/",O]})]}),e.jsx("p",{className:"mt-2 text-xs font-bold text-zinc-500",children:s.data.platform==="sms"?"SMS mode: short and direct copy works best.":"Telegram mode: you can use longer copy and richer tone."})]}),e.jsx("textarea",{ref:je,className:"min-h-[180px] w-full rounded-2xl border border-zinc-200 bg-white p-4 text-sm font-medium leading-relaxed focus:outline-none focus:ring-2 focus:ring-[#F57C00]/20 transition-all placeholder:text-zinc-300",value:s.data.message,maxLength:O,onChange:t=>s.setData("message",t.target.value),placeholder:s.data.platform==="sms"?"Example: Hi {customer_name}, enjoy 15% off your next order this week at your nearest branch.":"Example: Hello {customer_name}! We have a limited-time offer for you. Reply to this message to claim your promo."}),s.data.platform==="telegram"?e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"promo-telegram-button-text",children:"Telegram Button Text"}),e.jsx(d,{id:"promo-telegram-button-text",className:"h-11 rounded-xl border-zinc-200 focus:ring-[#F57C00]",value:s.data.telegram_button_text,maxLength:64,onChange:t=>s.setData("telegram_button_text",t.target.value),placeholder:"Open Offer"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"promo-telegram-button-url",children:"Telegram Button URL"}),e.jsx(d,{id:"promo-telegram-button-url",type:"url",className:"h-11 rounded-xl border-zinc-200 focus:ring-[#F57C00]",value:s.data.telegram_button_url,onChange:t=>s.setData("telegram_button_url",t.target.value),placeholder:"https://example.com/promo"})]}),e.jsx("p",{className:`text-[10px] font-black uppercase tracking-widest md:col-span-2 ${Y?"text-rose-500":"text-zinc-400"}`,children:Y?"Provide both Telegram button text and URL, or leave both empty.":"Optional: recipients will receive a primary inline URL button."})]}):null,e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"promo-template-label",children:"Template Label (used for Save Template + Send)"}),e.jsx(d,{id:"promo-template-label",className:"h-11 rounded-xl border-zinc-200 focus:ring-[#F57C00]",value:s.data.template_label,maxLength:255,onChange:t=>s.setData("template_label",t.target.value),placeholder:"Promo Campaign - Weekend Offer"})]}),s.errors.message||s.errors.telegram_button_text||s.errors.telegram_button_url||s.errors.template_label?e.jsxs("div",{className:"space-y-1 rounded-xl border border-rose-200 bg-rose-50 px-3 py-2",children:[s.errors.message?e.jsx("p",{className:"text-[11px] font-bold text-rose-700",children:s.errors.message}):null,s.errors.telegram_button_text?e.jsx("p",{className:"text-[11px] font-bold text-rose-700",children:s.errors.telegram_button_text}):null,s.errors.telegram_button_url?e.jsx("p",{className:"text-[11px] font-bold text-rose-700",children:s.errors.telegram_button_url}):null,s.errors.template_label?e.jsx("p",{className:"text-[11px] font-bold text-rose-700",children:s.errors.template_label}):null]}):null,e.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Campaign Summary"}),e.jsxs("div",{className:"mt-3 grid gap-3 md:grid-cols-2",children:[e.jsxs("p",{className:"text-xs font-bold text-zinc-500",children:["Platform: ",e.jsx("span",{className:"text-[#212121]",children:s.data.platform==="sms"?"SMS":"Telegram"})]}),e.jsxs("p",{className:"text-xs font-bold text-zinc-500",children:["Audience Preview: ",e.jsxs("span",{className:"text-[#212121]",children:[m?m.summary.matched_customers.toLocaleString():"0"," customers"]})]}),e.jsxs("p",{className:"text-xs font-bold text-zinc-500",children:["Orders Range: ",e.jsx("span",{className:"text-[#212121]",children:xt})]}),e.jsxs("p",{className:"text-xs font-bold text-zinc-500",children:["Recency Window: ",e.jsx("span",{className:"text-[#212121]",children:mt})]}),e.jsxs("p",{className:"text-xs font-bold text-zinc-500",children:["Total Spend: ",e.jsx("span",{className:"text-[#212121]",children:pt})]}),e.jsxs("p",{className:"text-xs font-bold text-zinc-500",children:["Average Order Value: ",e.jsx("span",{className:"text-[#212121]",children:ht})]}),e.jsxs("p",{className:"text-xs font-bold text-zinc-500",children:["Branches: ",e.jsx("span",{className:"text-[#212121]",children:ve.length===0?"All branches":ve.join(", ")})]}),e.jsxs("p",{className:"text-xs font-bold text-zinc-500 md:col-span-2",children:["Include item purchasers: ",e.jsx("span",{className:"text-[#212121]",children:we.length===0?"Any item":we.join(", ")})]}),e.jsxs("p",{className:"text-xs font-bold text-zinc-500 md:col-span-2",children:["Exclude item purchasers: ",e.jsx("span",{className:"text-[#212121]",children:ke.length===0?"No exclusions":ke.join(", ")})]}),e.jsxs("p",{className:"text-xs font-bold text-zinc-500 md:col-span-2",children:["Search keyword: ",e.jsx("span",{className:"text-[#212121]",children:s.data.search.trim()===""?"No keyword filter":s.data.search})]})]}),V.length>0?e.jsx("div",{className:"mt-4 flex flex-wrap gap-1.5",children:V.map(t=>e.jsx(o,{asChild:!0,variant:"outline",className:"rounded-lg border-zinc-200 bg-white px-0 py-0 text-[9px] font-bold text-zinc-500",children:e.jsx("button",{type:"button",className:"rounded-lg px-2 py-0.5 hover:bg-zinc-50",title:t.description,onClick:()=>Ze(t.token),children:`{${t.token}}`})},t.token))}):null]})]}):null]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 border-t border-zinc-100 bg-zinc-50/50 p-6",children:[e.jsx(c,{type:"button",variant:"outline",className:"h-11 rounded-xl border-zinc-200 font-bold",onClick:u===0?Z:nt,children:u===0?"Cancel":e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"mr-2 size-4"}),"Previous"]})}),Ye?e.jsxs("div",{className:"space-y-2 text-right",children:[e.jsxs("div",{className:"flex flex-wrap justify-end gap-2",children:[e.jsx(c,{type:"button",className:"h-11 rounded-xl bg-[#F57C00] px-7 font-black uppercase tracking-widest hover:bg-[#E65100]",disabled:!M||s.processing,onClick:()=>Le("send"),children:s.processing&&me==="send"?"Sending...":"Send Promo"}),e.jsx(c,{type:"button",className:"h-11 rounded-xl bg-[#212121] px-7 font-black uppercase tracking-widest hover:bg-[#F57C00]",disabled:!M||s.processing,onClick:()=>Le("save_send"),children:s.processing&&me==="save_send"?"Saving + Sending...":"Save Template + Send"})]}),M?null:e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Preview and message are required before sending."})]}):e.jsxs(c,{type:"button",className:"h-11 rounded-xl bg-[#F57C00] px-8 font-black uppercase tracking-widest hover:bg-[#E65100]",disabled:!gt,onClick:lt,children:["Next",e.jsx(Oe,{className:"ml-2 size-4"})]})]})]})}),e.jsx(se,{open:Xe,onOpenChange:t=>{if(t){_(!0);return}Me()},children:e.jsxs(ae,{className:"border-none p-0 sm:max-w-2xl",children:[e.jsxs(re,{className:"border-b border-zinc-100 bg-zinc-50/70 p-6",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#F57C00]",children:"Final Confirmation"}),e.jsx(ne,{className:"mt-1 text-xl font-black text-[#212121]",children:"Review promo preview before sending"}),e.jsx(le,{className:"mt-1 text-xs font-bold text-zinc-500",children:"This preview is generated from a sample customer in your current audience."})]}),e.jsxs("div",{className:"space-y-4 p-6",children:[e.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white px-4 py-3",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Platform"}),e.jsx("p",{className:"mt-1 text-sm font-black text-[#212121]",children:s.data.platform==="telegram"?"Telegram":"SMS"})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white px-4 py-3",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Audience"}),e.jsxs("p",{className:"mt-1 text-sm font-black text-[#212121]",children:[(m?.summary.matched_customers??0).toLocaleString()," customers"]})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-white px-4 py-3",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Action"}),e.jsx("p",{className:"mt-1 text-sm font-black text-[#212121]",children:Ae})]})]}),e.jsxs("div",{className:"rounded-xl border border-zinc-200 bg-zinc-50/60 px-4 py-3",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-500",children:"Sample Recipient"}),E?e.jsxs("p",{className:"mt-1 text-xs font-bold text-zinc-700",children:[E.name," (",E.phone,")",E.telegram_username?` Â· @${E.telegram_username}`:""]}):e.jsx("p",{className:"mt-1 text-xs font-bold text-zinc-700",children:"Audience preview sample unavailable. Unknown placeholders stay as tokens."})]}),e.jsxs("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Message Preview"}),e.jsx("div",{className:"mt-2 rounded-xl border border-zinc-200 bg-zinc-50/50 p-4 text-sm font-bold leading-relaxed text-zinc-700 whitespace-pre-wrap",children:Fe.trim()===""?"Preview is empty for this sample.":Fe}),s.data.platform==="telegram"&&s.data.telegram_button_text.trim()!==""&&s.data.telegram_button_url.trim()!==""?e.jsxs("div",{className:"mt-3 rounded-xl border border-sky-200 bg-sky-50 px-3 py-2",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-sky-600",children:"Telegram Inline Button"}),e.jsxs("p",{className:"mt-1 text-xs font-bold text-sky-700",children:[s.data.telegram_button_text," (",s.data.telegram_button_url,")"]})]}):null]}),e.jsxs("div",{className:"space-y-2 rounded-xl border border-amber-200 bg-amber-50 px-4 py-3",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-amber-700",children:"Placeholder Warning"}),e.jsx("p",{className:"text-xs font-bold leading-relaxed text-amber-800",children:"Placeholder values are customer-specific, so final messages can vary per recipient."}),ut?e.jsxs("p",{className:"text-xs font-bold leading-relaxed text-amber-800",children:["You used both ","{recent_item}"," and ","{freq_item}",". They can resolve to the same item for some customers, so the promo might look repetitive by accident."]}):null,bt?e.jsxs("p",{className:"text-xs font-bold leading-relaxed text-amber-800",children:['In this sample preview, both tokens resolved to "',Q,'".']}):null]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 border-t border-zinc-100 bg-zinc-50/60 p-6",children:[e.jsx(c,{type:"button",variant:"outline",className:"h-11 rounded-xl border-zinc-200 font-bold",disabled:s.processing,onClick:Me,children:"Cancel"}),e.jsx(c,{type:"button",className:"h-11 rounded-xl bg-[#F57C00] px-8 font-black uppercase tracking-widest hover:bg-[#E65100]",disabled:s.processing||$===null,onClick:jt,children:s.processing?Pe?"Saving + Sending...":"Sending...":Ae})]})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3 lg:grid-cols-6",children:[e.jsx(h,{className:"border-none shadow-sm ring-1 ring-zinc-200",children:e.jsxs(g,{className:"pt-6",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Blueprints"}),e.jsx("h3",{className:"mt-1 text-2xl font-black text-[#212121]",children:f.total_templates})]})}),e.jsx(h,{className:"border-none shadow-sm ring-1 ring-zinc-200",children:e.jsxs(g,{className:"pt-6",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#F57C00]",children:"Active"}),e.jsx("h3",{className:"mt-1 text-2xl font-black text-[#212121]",children:f.active_templates})]})}),e.jsx(h,{className:"border-none shadow-sm ring-1 ring-zinc-200",children:e.jsxs(g,{className:"pt-6",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Automation"}),e.jsxs("h3",{className:"mt-1 text-2xl font-black text-[#212121]",children:[f.enabled_events,"/",f.notification_events]})]})}),e.jsx(h,{className:"border-none shadow-sm ring-1 ring-zinc-200",children:e.jsxs(g,{className:"pt-6",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-emerald-500",children:"Whitelist"}),e.jsx("h3",{className:"mt-1 text-2xl font-black text-[#212121]",children:f.whitelist_count})]})}),e.jsx(h,{className:"border-none shadow-sm ring-1 ring-zinc-200",children:e.jsxs(g,{className:"pt-6",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-rose-500",children:"Restricted"}),e.jsx("h3",{className:"mt-1 text-2xl font-black text-[#212121]",children:f.blacklist_count})]})}),e.jsx(h,{className:"border-none shadow-sm ring-1 ring-zinc-200",children:e.jsxs(g,{className:"pt-6",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Reach"}),e.jsx("h3",{className:"mt-1 text-2xl font-black text-[#212121]",children:f.customers_count})]})})]}),e.jsxs("div",{className:"grid gap-8 lg:grid-cols-[380px_1fr]",children:[e.jsxs(h,{className:"border-none shadow-md ring-1 ring-zinc-200 h-fit",children:[e.jsx(w,{className:"border-b border-zinc-100 bg-zinc-50/50 py-5",children:e.jsx(k,{className:"text-sm font-black uppercase tracking-widest text-[#212121]",children:"Message blueprints"})}),e.jsx(g,{className:"p-2 space-y-2",children:N.map(t=>{const a=j?.id===t.id;return e.jsxs("button",{type:"button",className:`w-full rounded-2xl p-4 text-left transition-all ${a?"bg-[#212121] text-white shadow-xl":"hover:bg-zinc-100 group"}`,onClick:()=>_e(t),children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("p",{className:`text-xs font-black uppercase tracking-wide ${a?"text-white":"text-[#212121]"}`,children:t.label}),t.is_active?e.jsx(Ct,{className:`size-3.5 ${a?"text-emerald-400":"text-emerald-500"}`}):e.jsx(Pt,{className:`size-3.5 ${a?"text-white/40":"text-zinc-300"}`})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:`text-[10px] font-black uppercase tracking-tighter ${a?"text-white/40":"text-zinc-400"}`,children:["Ref: ",t.key]}),e.jsx(o,{variant:"outline",className:`text-[9px] font-black uppercase tracking-widest border-none p-0 ${a?"text-white/60":"bg-transparent text-zinc-400 group-hover:text-[#F57C00]"}`,children:"Load blueprint"})]})]},t.id)})})]}),e.jsxs(h,{className:"border-none shadow-xl ring-1 ring-zinc-200",children:[e.jsx(w,{className:"border-b border-zinc-100 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#F57C00]",children:"Editor console"}),e.jsx(k,{className:"mt-1 text-xl font-black text-[#212121]",children:j?j.label:"Select Blueprint"})]}),j&&e.jsxs(o,{className:"bg-[#212121] text-white font-black uppercase tracking-[0.2em] text-[9px] px-3 py-1",children:["System-",j.key]})]})}),e.jsx(g,{className:"pt-8",children:j?e.jsxs("form",{className:"space-y-8",onSubmit:et,children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"template-label",children:"Display name"}),e.jsx(d,{id:"template-label",className:"h-11 rounded-xl border-zinc-200 focus:ring-[#F57C00]",value:n.data.label,onChange:t=>n.setData("label",t.target.value)}),e.jsx(F,{message:n.errors.label})]}),e.jsx("div",{className:"flex items-center gap-4 mt-6",children:e.jsxs("div",{className:"flex items-center gap-2 rounded-xl bg-zinc-50 px-4 py-2.5 ring-1 ring-zinc-200",children:[e.jsx("input",{type:"checkbox",id:"is_active_check",className:"h-4 w-4 rounded border-zinc-300 text-[#F57C00] focus:ring-[#F57C00]/20",checked:n.data.is_active,onChange:t=>n.setData("is_active",t.target.checked)}),e.jsx(i,{htmlFor:"is_active_check",className:"cursor-pointer text-xs font-bold text-zinc-600",children:"Active status"})]})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"template-body",children:"SMS Body"}),e.jsxs("span",{className:`text-[10px] font-black ${n.data.body.length>300?"text-rose-500":"text-zinc-400"}`,children:[n.data.body.length,"/480 Content Length"]})]}),e.jsx("textarea",{id:"template-body",ref:Ne,className:"min-h-[220px] w-full rounded-2xl border border-zinc-200 bg-white p-5 text-sm font-medium leading-relaxed focus:outline-none focus:ring-2 focus:ring-[#F57C00]/20 transition-all placeholder:text-zinc-300",value:n.data.body,maxLength:480,onChange:t=>n.setData("body",t.target.value)}),e.jsx(F,{message:n.errors.body})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{type:"submit",disabled:n.processing,className:"h-12 px-10 rounded-xl bg-[#F57C00] font-black shadow-lg shadow-[#F57C00]/20 hover:bg-[#E65100]",children:n.processing?"Syncing...":"Commit Changes"}),e.jsx(c,{type:"button",variant:"outline",className:"h-12 rounded-xl font-bold border-zinc-200",onClick:()=>_e(j),children:"Revert"})]})]}):e.jsx("div",{className:"py-20 text-center",children:e.jsx("p",{className:"text-zinc-400 font-bold uppercase tracking-widest text-xs",children:"Select a blueprint from the catalog to begin editing"})})})]})]}),e.jsxs(h,{className:"border-none shadow-md ring-1 ring-zinc-200",children:[e.jsx(w,{className:"border-b border-zinc-100 bg-zinc-50/50 py-4",children:e.jsxs(k,{className:"flex items-center gap-2 text-xs font-black uppercase tracking-widest text-[#212121]",children:[e.jsx(Mt,{className:"size-4 text-[#F57C00]"}),"Variable Library"]})}),e.jsx(g,{className:"pt-6",children:e.jsx("div",{className:"flex flex-wrap gap-3",children:V.map(t=>e.jsxs("button",{type:"button",className:"group relative flex items-center gap-2 rounded-xl bg-white px-4 py-2 text-left ring-1 ring-zinc-200 transition-all hover:ring-[#F57C00]/30 hover:shadow-sm",onClick:()=>Qe(t.token),title:t.description,children:[e.jsx("code",{className:"text-xs font-black text-[#F57C00]",children:`{${t.token}}`}),e.jsx("span",{className:"text-[10px] font-bold text-zinc-400 uppercase tracking-tighter",children:t.description})]},t.token))})})]}),e.jsxs(h,{className:"border-none shadow-md ring-1 ring-zinc-200",children:[e.jsx(w,{className:"border-b border-zinc-100 bg-zinc-50/50 py-5",children:e.jsxs(k,{className:"flex items-center gap-2 text-sm font-black uppercase tracking-widest text-[#212121]",children:[e.jsx(yt,{className:"size-4 text-[#F57C00]"}),"Trigger mechanisms"]})}),e.jsx(g,{className:"pt-6",children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:Ue.map(t=>e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-2xl border border-zinc-100 bg-white p-5 transition-all hover:ring-1 hover:ring-[#F57C00]/20",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs font-black text-[#212121] uppercase tracking-wide",children:t.label}),e.jsx("p",{className:"text-[10px] font-bold text-zinc-500 leading-relaxed",children:t.description}),e.jsxs(o,{variant:"outline",className:"mt-2 rounded-md border-none bg-zinc-100 text-[9px] font-black uppercase text-zinc-400",children:["Event: ",t.event_key]})]}),e.jsx(c,{type:"button",size:"sm",variant:t.is_enabled?"default":"outline",className:`h-9 rounded-xl px-6 font-black uppercase tracking-tighter text-[10px] transition-all ${t.is_enabled?"bg-[#212121] text-white":"text-zinc-400"}`,disabled:Ve===t.id,onClick:()=>tt(t),children:t.is_enabled?"Active":"Offline"})]},t.id))})})]}),e.jsxs("div",{className:"grid gap-8 lg:grid-cols-2",children:[e.jsxs(h,{className:"border-none shadow-md ring-1 ring-zinc-200",children:[e.jsx(w,{className:"border-b border-zinc-100 py-5",children:e.jsxs(k,{className:"flex items-center gap-2 text-sm font-black uppercase tracking-widest text-[#212121]",children:[e.jsx(_t,{className:"size-4 text-[#F57C00]"}),"Audience filtering"]})}),e.jsx(g,{className:"pt-6",children:e.jsxs("form",{className:"space-y-6",onSubmit:st,children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"phone",children:"Phone terminal"}),e.jsx(d,{id:"phone",className:"h-11 rounded-xl border-zinc-200",value:p.data.phone,onChange:t=>p.setData("phone",t.target.value),placeholder:"2519..."}),e.jsx(F,{message:p.errors.phone})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"list_type",children:"Access level"}),e.jsxs("select",{id:"list_type",className:"h-11 w-full rounded-xl border border-zinc-200 bg-white px-3 text-xs font-bold focus:outline-none focus:ring-2 focus:ring-[#F57C00]/20",value:p.data.list_type,onChange:t=>p.setData("list_type",t.target.value),children:[e.jsx("option",{value:"whitelist",children:"Whitelist (Allow)"}),e.jsx("option",{value:"blacklist",children:"Blacklist (Restrict)"})]}),e.jsx(F,{message:p.errors.list_type})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(i,{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",htmlFor:"note",children:"Administrative note"}),e.jsx(d,{id:"note",className:"h-11 rounded-xl border-zinc-200",value:p.data.note,onChange:t=>p.setData("note",t.target.value),placeholder:"Reason for listing..."}),e.jsx(F,{message:p.errors.note})]}),e.jsx(c,{type:"submit",disabled:p.processing,className:"h-11 w-full rounded-xl bg-[#212121] font-black hover:bg-[#F57C00] transition-colors",children:p.processing?"Registering...":"Add to Filter"})]})})]}),e.jsxs(h,{className:"border-none shadow-md ring-1 ring-zinc-200",children:[e.jsx(w,{className:"border-b border-zinc-100 py-5",children:e.jsxs(k,{className:"flex items-center gap-2 text-sm font-black uppercase tracking-widest text-[#212121]",children:[e.jsx(qe,{className:"size-4 text-[#F57C00]"}),"Batch Import"]})}),e.jsx(g,{className:"pt-6",children:e.jsxs("form",{className:"space-y-6",onSubmit:at,children:[e.jsxs("div",{className:"rounded-2xl border-2 border-dashed border-zinc-100 bg-zinc-50/50 p-8 text-center transition-all hover:bg-white hover:border-[#F57C00]/20",children:[e.jsx(qe,{className:"mx-auto size-10 text-zinc-300"}),e.jsx("p",{className:"mt-4 text-xs font-bold text-zinc-500 uppercase",children:"Support CSV (name, phone)"}),e.jsx(d,{id:"contacts_file",type:"file",className:"mt-6 h-11 border-none bg-transparent p-0 file:h-11 file:rounded-xl file:border-0 file:bg-zinc-200 file:px-6 file:text-xs file:font-black file:uppercase",accept:".csv,text/csv,.txt,text/plain",onChange:t=>v.setData("contacts_file",t.target.files?.[0]??null)},He),e.jsx(F,{message:v.errors.contacts_file})]}),e.jsx(c,{type:"submit",className:"h-11 w-full rounded-xl bg-[#212121] font-black hover:bg-[#F57C00] transition-colors",disabled:v.processing||!v.data.contacts_file,children:v.processing?"Ingesting Data...":"Start Global Import"})]})})]})]}),e.jsxs(h,{className:"border-none shadow-md ring-1 ring-zinc-200",children:[e.jsx(w,{className:"border-b border-zinc-100 bg-zinc-50/50 py-5",children:e.jsxs(k,{className:"flex items-center gap-2 text-sm font-black uppercase tracking-widest text-[#212121]",children:[e.jsx(St,{className:"size-4 text-[#F57C00]"}),"Filtering Journal"]})}),e.jsx(g,{className:"p-0",children:e.jsxs("div",{className:"grid lg:grid-cols-2 divide-x divide-zinc-100",children:[e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6 flex items-center justify-between",children:e.jsxs("h4",{className:"text-xs font-black uppercase tracking-widest text-emerald-600 flex items-center gap-2",children:[e.jsx("div",{className:"size-2 rounded-full bg-emerald-500 animate-pulse"}),"Whitelisted (",X.length,")"]})}),e.jsx("div",{className:"space-y-3",children:X.length===0?e.jsx("p",{className:"py-8 text-center text-[10px] font-bold uppercase text-zinc-300",children:"No entries"}):X.map(t=>e.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-white p-3 ring-1 ring-zinc-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-black text-[#212121]",children:t.phone}),t.note&&e.jsx("p",{className:"text-[9px] font-bold text-zinc-400 mt-0.5",children:t.note})]}),e.jsx(c,{size:"sm",variant:"ghost",className:"h-8 rounded-lg text-rose-500 hover:bg-rose-50 font-bold text-[10px] uppercase",disabled:de===t.id,onClick:()=>ze(t.id),children:"Purge"})]},t.id))})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6 flex items-center justify-between",children:e.jsxs("h4",{className:"text-xs font-black uppercase tracking-widest text-rose-600 flex items-center gap-2",children:[e.jsx("div",{className:"size-2 rounded-full bg-rose-500"}),"Restricted (",K.length,")"]})}),e.jsx("div",{className:"space-y-3",children:K.length===0?e.jsx("p",{className:"py-8 text-center text-[10px] font-bold uppercase text-zinc-300",children:"No restrictions"}):K.map(t=>e.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-white p-3 ring-1 ring-zinc-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-black text-[#212121]",children:t.phone}),t.note&&e.jsx("p",{className:"text-[9px] font-bold text-zinc-400 mt-0.5",children:t.note})]}),e.jsx(c,{size:"sm",variant:"ghost",className:"h-8 rounded-lg text-rose-500 hover:bg-rose-50 font-bold text-[10px] uppercase",disabled:de===t.id,onClick:()=>ze(t.id),children:"Restore"})]},t.id))})]})]})})]})]})]})}export{ms as default};
