import{c as st,r as g,u as nt,j as t,H as lt,L as it}from"./app-XqpdAWDD.js";import{I as He}from"./input-error-BYm0QZl2.js";import{B as rt}from"./badge-CpEQKSDS.js";import{B as ke}from"./createLucideIcon-Th9lyFeF.js";import{I as at}from"./input-ClbFjSrq.js";import{C as ct}from"./circle-check-5KbnMnTL.js";import{Q as ot,S as dt}from"./store-CTrG6B4i.js";import{S as mt}from"./shopping-cart-PE_jaIQD.js";import{T as ft}from"./table-2-C6thJ85d.js";import{S as ut}from"./search-DiFoPkFw.js";/* empty css            */function Be(n){return new Intl.NumberFormat("en-ET",{style:"currency",currency:"ETB",maximumFractionDigits:2}).format(n)}function Je(n,e){if(!n||typeof n!="object"||Array.isArray(n))return{};const a={};return Object.entries(n).forEach(([Z,p])=>{const i=Number(Z),r=typeof p=="number"?p:Number(p);!Number.isInteger(i)||i<1||!e.has(i)||!Number.isInteger(r)||r<1||r>100||(a[i]=r)}),a}function xt(n,e){if(typeof window>"u")return{};try{const a=window.localStorage.getItem(n);return a?Je(JSON.parse(a),e):{}}catch{return{}}}function pt(n,e){if(!(typeof window>"u"))try{if(Object.keys(e).length===0){window.localStorage.removeItem(n);return}window.localStorage.setItem(n,JSON.stringify(e))}catch{}}function ht(n){if(!(typeof window>"u"))try{window.localStorage.removeItem(n)}catch{}}function Lt(n){const e=st.c(139),{menuItems:a,categories:Z,customerToken:p,table:i,tableSession:r,filters:Me,staffRoute:ee}=n,x=`kds:customer:qr-cart:${i.qr_code}:${p}`;let te;e[0]!==a?(te=new Set(a.map(kt)),e[0]=a,e[1]=te):te=e[1];const b=te,[h,Ue]=g.useState(Me.search??""),[o,De]=g.useState(Me.category??"all"),[Qe,ze]=g.useState(!1),Se=g.useRef(0);let se;e[2]!==b||e[3]!==x?(se=()=>xt(x,b),e[2]=b,e[3]=x,e[4]=se):se=e[4];const[c,Ye]=g.useState(se);let ne;e[5]!==p||e[6]!==r.token?(ne={customer_token:p,table_session_token:r.token},e[5]=p,e[6]=r.token,e[7]=ne):ne=e[7];const f=nt(ne);let le;e[8]!==a?(le=a.reduce(vt,{}),e[8]=a,e[9]=le):le=e[9];const Ce=le;let ie;if(e[10]!==o||e[11]!==a||e[12]!==h){let s;e[14]!==o||e[15]!==h?(s=l=>{const d=o==="all"||(l.category??"Uncategorized")===o,m=h.toLowerCase(),ve=!m||l.name.toLowerCase().includes(m)||(l.description??"").toLowerCase().includes(m)||(l.category??"").toLowerCase().includes(m);return d&&ve},e[14]=o,e[15]=h,e[16]=s):s=e[16],ie=a.filter(s),e[10]=o,e[11]=a,e[12]=h,e[13]=ie}else ie=e[13];const re=ie;let j;e[17]!==c?(j=Object.entries(c),e[17]=c,e[18]=j):j=e[18];let ae;e[19]!==Ce||e[20]!==j?(ae=j.map(s=>{const[l,d]=s,m=Ce[Number(l)];return!m||d<1?null:{...m,quantity:d,lineTotal:m.price*d}}).filter(Nt),e[19]=Ce,e[20]=j,e[21]=ae):ae=e[21];const u=ae;let ce;e[22]!==u?(ce=u.reduce(wt,0),e[22]=u,e[23]=ce):ce=e[23];const _e=ce,Ve=u.reduce(yt,0);let oe,de;e[24]!==b||e[25]!==c||e[26]!==x?(de=()=>{pt(x,Je(c,b))},oe=[c,x,b],e[24]=b,e[25]=c,e[26]=x,e[27]=oe,e[28]=de):(oe=e[27],de=e[28]),g.useEffect(de,oe);let me,fe;e[29]===Symbol.for("react.memo_cache_sentinel")?(me=()=>{if(typeof window>"u")return;let s=!1;const l=()=>{s||(s=!0,window.requestAnimationFrame(()=>{const d=window.scrollY||0;if(window.matchMedia("(min-width: 768px)").matches){ze(!1),Se.current=d,s=!1;return}const ve=d-Se.current,tt=d>96;ve>6&&tt?ze(!0):(ve<-6||d<32)&&ze(!1),Se.current=d,s=!1}))};return window.addEventListener("scroll",l,{passive:!0}),window.addEventListener("resize",l),l(),()=>{window.removeEventListener("scroll",l),window.removeEventListener("resize",l)}},fe=[],e[29]=me,e[30]=fe):(me=e[29],fe=e[30]),g.useEffect(me,fe);let ue;e[31]===Symbol.for("react.memo_cache_sentinel")?(ue=(s,l)=>{Ye(d=>{const m={...d};return l<=0?delete m[s]:m[s]=l,m})},e[31]=ue):ue=e[31];const Ee=ue;let xe;e[32]!==u||e[33]!==x||e[34]!==f||e[35]!==i.qr_code||e[36]!==r.token?(xe=()=>{const s=u.map(jt);f.transform(l=>({...l,items:s})),f.post(`/qr-menu/${i.qr_code}/orders?session=${encodeURIComponent(r.token)}`,{preserveScroll:!0,onSuccess:()=>{ht(x),Ye({})},onError:gt})},e[32]=u,e[33]=x,e[34]=f,e[35]=i.qr_code,e[36]=r.token,e[37]=xe):xe=e[37];const Fe=xe,Ie=`QR Menu • ${i.name}`;let y;e[38]!==Ie?(y=t.jsx(lt,{title:Ie}),e[38]=Ie,e[39]=y):y=e[39];const Ge="min-h-screen bg-[#FAFAFA] text-[#212121]",Ke="mx-auto w-full max-w-7xl px-4 py-8 md:px-8",qe=`sticky top-0 z-40 mb-6 rounded-3xl bg-white p-6 shadow-sm ring-1 ring-zinc-200 transition-all duration-300 md:relative md:top-0 md:translate-y-0 md:opacity-100 md:pointer-events-auto ${Qe?"-translate-y-[120%] opacity-0 pointer-events-none":"translate-y-0 opacity-100"}`;let pe;e[40]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-[#9E9E9E]",children:"Table QR Order"}),e[40]=pe):pe=e[40];let he;e[41]===Symbol.for("react.memo_cache_sentinel")?(he=t.jsx(ft,{className:"size-6 text-[#F57C00]"}),e[41]=he):he=e[41];let w;e[42]!==i.name?(w=t.jsxs("h1",{className:"mt-2 flex items-center gap-2 text-2xl font-black text-[#212121]",children:[he,i.name]}),e[42]=i.name,e[43]=w):w=e[43];let N;e[44]!==i.pickup_location.address||e[45]!==i.pickup_location.name?(N=t.jsxs("p",{className:"mt-1 text-sm font-medium text-zinc-500",children:[i.pickup_location.name," • ",i.pickup_location.address]}),e[44]=i.pickup_location.address,e[45]=i.pickup_location.name,e[46]=N):N=e[46];let v;e[47]!==w||e[48]!==N?(v=t.jsxs("div",{children:[pe,w,N]}),e[47]=w,e[48]=N,e[49]=v):v=e[49];const Te=r.is_verified?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700";let k;e[50]!==r.is_verified?(k=r.is_verified?t.jsxs(t.Fragment,{children:[t.jsx(ct,{className:"mr-1 size-3"}),"Session Verified"]}):t.jsxs(t.Fragment,{children:[t.jsx(ot,{className:"mr-1 size-3"}),"Session Pending Verify"]}),e[50]=r.is_verified,e[51]=k):k=e[51];let z;e[52]!==Te||e[53]!==k?(z=t.jsx(rt,{className:Te,children:k}),e[52]=Te,e[53]=k,e[54]=z):z=e[54];let S;e[55]!==r.token?(S=r.token.slice(0,16),e[55]=r.token,e[56]=S):S=e[56];let C;e[57]!==S?(C=t.jsxs("p",{className:"text-[11px] font-mono text-zinc-400",children:[S,"..."]}),e[57]=S,e[58]=C):C=e[58];let _;e[59]!==ee?(_=ee?t.jsx(it,{href:ee,className:"text-xs font-bold text-[#F57C00] hover:underline",children:"Staff Dashboard"}):null,e[59]=ee,e[60]=_):_=e[60];let E;e[61]!==z||e[62]!==C||e[63]!==_?(E=t.jsxs("div",{className:"flex flex-col items-end gap-2",children:[z,C,_]}),e[61]=z,e[62]=C,e[63]=_,e[64]=E):E=e[64];let F;e[65]!==v||e[66]!==E?(F=t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[v,E]}),e[65]=v,e[66]=E,e[67]=F):F=e[67];let I;e[68]!==qe||e[69]!==F?(I=t.jsx("div",{className:qe,children:F}),e[68]=qe,e[69]=F,e[70]=I):I=e[70];const We="grid gap-8 lg:grid-cols-[1fr_360px]",Oe=`sticky top-4 z-30 rounded-2xl bg-white/95 p-3 shadow-sm ring-1 ring-zinc-200 transition-all duration-300 backdrop-blur md:relative md:top-0 md:bg-transparent md:p-0 md:shadow-none md:ring-0 md:translate-y-0 md:opacity-100 md:pointer-events-auto ${Qe?"-translate-y-[120%] opacity-0 pointer-events-none":"translate-y-0 opacity-100"}`;let be;e[71]===Symbol.for("react.memo_cache_sentinel")?(be=t.jsx(ut,{className:"absolute top-1/2 left-4 size-4 -translate-y-1/2 text-zinc-400"}),e[71]=be):be=e[71];let ge;e[72]===Symbol.for("react.memo_cache_sentinel")?(ge=s=>Ue(s.target.value),e[72]=ge):ge=e[72];let q;e[73]!==h?(q=t.jsxs("div",{className:"relative",children:[be,t.jsx(at,{className:"h-12 rounded-2xl border-zinc-200 pl-10 focus:ring-[#F57C00]",value:h,onChange:ge,placeholder:"Search menu items"})]}),e[73]=h,e[74]=q):q=e[74];const Ae=o==="all"?"bg-[#F57C00] hover:bg-[#E65100]":"",Le=o==="all"?"default":"outline";let je;e[75]===Symbol.for("react.memo_cache_sentinel")?(je=()=>De("all"),e[75]=je):je=e[75];let T;e[76]!==Ae||e[77]!==Le?(T=t.jsx(ke,{type:"button",size:"sm",className:Ae,variant:Le,onClick:je,children:"All"}),e[76]=Ae,e[77]=Le,e[78]=T):T=e[78];let O;if(e[79]!==o||e[80]!==Z){let s;e[82]!==o?(s=l=>t.jsx(ke,{type:"button",size:"sm",className:o===l?"bg-[#F57C00] hover:bg-[#E65100]":"",variant:o===l?"default":"outline",onClick:()=>De(l),children:l},l),e[82]=o,e[83]=s):s=e[83],O=Z.map(s),e[79]=o,e[80]=Z,e[81]=O}else O=e[81];let A;e[84]!==T||e[85]!==O?(A=t.jsxs("div",{className:"flex flex-wrap gap-2",children:[T,O]}),e[84]=T,e[85]=O,e[86]=A):A=e[86];let L;e[87]!==q||e[88]!==A?(L=t.jsxs("div",{className:"space-y-4",children:[q,A]}),e[87]=q,e[88]=A,e[89]=L):L=e[89];let P;e[90]!==Oe||e[91]!==L?(P=t.jsx("div",{className:Oe,children:L}),e[90]=Oe,e[91]=L,e[92]=P):P=e[92];let R;e[93]!==c||e[94]!==re?(R=re.length===0?t.jsx("div",{className:"rounded-2xl bg-white p-10 text-center ring-1 ring-zinc-200",children:t.jsx("p",{className:"text-sm font-bold text-zinc-500",children:"No items found for this search."})}):t.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:re.map(s=>t.jsxs("div",{className:"overflow-hidden rounded-2xl bg-white shadow-sm ring-1 ring-zinc-200",children:[t.jsx("div",{className:"aspect-[4/3] bg-zinc-100",children:s.image_url?t.jsx("img",{src:s.image_url,alt:s.name,className:"h-full w-full object-cover",loading:"lazy"}):t.jsx("div",{className:"flex h-full w-full items-center justify-center text-zinc-400",children:t.jsx(mt,{className:"size-8"})})}),t.jsxs("div",{className:"space-y-3 p-4",children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-black text-zinc-900",children:s.name}),t.jsx("p",{className:"text-sm text-zinc-500",children:s.description??"Freshly prepared for your table."})]}),t.jsx("p",{className:"text-sm font-black text-[#F57C00]",children:Be(s.price)})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-zinc-50 p-1 ring-1 ring-zinc-200",children:[t.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-white text-sm font-black text-zinc-700 hover:bg-[#F57C00] hover:text-white",onClick:()=>Ee(s.id,(c[s.id]??0)-1),children:"-"}),t.jsx("span",{className:"w-8 text-center text-sm font-black",children:c[s.id]??0}),t.jsx("button",{type:"button",className:"flex h-8 w-8 items-center justify-center rounded-full bg-white text-sm font-black text-zinc-700 hover:bg-[#F57C00] hover:text-white",onClick:()=>Ee(s.id,(c[s.id]??0)+1),children:"+"})]}),t.jsx(ke,{type:"button",size:"sm",className:(c[s.id]??0)>0?"bg-emerald-600 hover:bg-emerald-700":"bg-[#F57C00] hover:bg-[#E65100]",onClick:()=>Ee(s.id,Math.max(1,(c[s.id]??0)+1)),children:(c[s.id]??0)>0?"Add more":"Add"})]})]})]},s.id))}),e[93]=c,e[94]=re,e[95]=R):R=e[95];let $;e[96]!==P||e[97]!==R?($=t.jsxs("section",{className:"space-y-6",children:[P,R]}),e[96]=P,e[97]=R,e[98]=$):$=e[98];const Xe="sticky top-6 space-y-6",Ze="rounded-2xl bg-white p-5 shadow-sm ring-1 ring-zinc-200";let B;e[99]===Symbol.for("react.memo_cache_sentinel")?(B=t.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-zinc-500",children:"Your Table Order"}),e[99]=B):B=e[99];const et="mt-1 text-2xl font-black text-zinc-900",Pe=Be(Ve);let M;e[100]!==Pe?(M=t.jsx("p",{className:et,children:Pe}),e[100]=Pe,e[101]=M):M=e[101];let D;e[102]!==_e?(D=t.jsxs("p",{className:"mt-1 text-sm font-medium text-zinc-500",children:[_e," item(s)"]}),e[102]=_e,e[103]=D):D=e[103];let Q;e[104]!==u?(Q=u.length===0?t.jsx("p",{className:"rounded-xl bg-zinc-50 p-3 text-sm font-medium text-zinc-500",children:"No items selected yet."}):u.map(bt),e[104]=u,e[105]=Q):Q=e[105];let Y;e[106]!==Q?(Y=t.jsx("div",{className:"mt-4 space-y-2",children:Q}),e[106]=Q,e[107]=Y):Y=e[107];let H;e[108]!==f.errors.items?(H=t.jsx(He,{message:f.errors.items}),e[108]=f.errors.items,e[109]=H):H=e[109];let J;e[110]!==B||e[111]!==M||e[112]!==D||e[113]!==Y||e[114]!==H?(J=t.jsxs("div",{className:Ze,children:[B,M,D,Y,H]}),e[110]=B,e[111]=M,e[112]=D,e[113]=Y,e[114]=H,e[115]=J):J=e[115];let ye;e[116]===Symbol.for("react.memo_cache_sentinel")?(ye=t.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[t.jsx(dt,{className:"size-4 text-[#F57C00]"}),t.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-zinc-500",children:"Place Order"})]}),e[116]=ye):ye=e[116];let we;e[117]===Symbol.for("react.memo_cache_sentinel")?(we=t.jsx("p",{className:"rounded-xl bg-zinc-50 px-3 py-3 text-xs font-medium text-zinc-600 ring-1 ring-zinc-200",children:"No contact details required for table QR orders."}),e[117]=we):we=e[117];let U;e[118]!==f.errors.table_session_token?(U=t.jsx(He,{message:f.errors.table_session_token}),e[118]=f.errors.table_session_token,e[119]=U):U=e[119];const Re=f.processing||u.length===0,$e=f.processing?"Placing Order...":"Place Table Order";let V;e[120]!==Fe||e[121]!==Re||e[122]!==$e?(V=t.jsx(ke,{type:"button",className:"h-11 w-full rounded-xl bg-[#212121] font-black text-white hover:bg-black",disabled:Re,onClick:Fe,children:$e}),e[120]=Fe,e[121]=Re,e[122]=$e,e[123]=V):V=e[123];let G;e[124]!==U||e[125]!==V?(G=t.jsxs("div",{className:"rounded-2xl bg-white p-5 shadow-sm ring-1 ring-zinc-200",children:[ye,t.jsxs("div",{className:"space-y-4",children:[we,U,V]})]}),e[124]=U,e[125]=V,e[126]=G):G=e[126];let K;e[127]!==J||e[128]!==G?(K=t.jsx("aside",{children:t.jsxs("div",{className:Xe,children:[J,G]})}),e[127]=J,e[128]=G,e[129]=K):K=e[129];let W;e[130]!==$||e[131]!==K?(W=t.jsxs("div",{className:We,children:[$,K]}),e[130]=$,e[131]=K,e[132]=W):W=e[132];let X;e[133]!==I||e[134]!==W?(X=t.jsx("div",{className:Ge,children:t.jsxs("main",{className:Ke,children:[I,W]})}),e[133]=I,e[134]=W,e[135]=X):X=e[135];let Ne;return e[136]!==y||e[137]!==X?(Ne=t.jsxs(t.Fragment,{children:[y,X]}),e[136]=y,e[137]=X,e[138]=Ne):Ne=e[138],Ne}function bt(n){return t.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-zinc-50 px-3 py-2",children:[t.jsxs("span",{className:"truncate text-sm font-bold text-zinc-800",children:[n.name," x",n.quantity]}),t.jsx("span",{className:"text-sm font-black text-zinc-900",children:Be(n.lineTotal)})]},n.id)}function gt(n){n.table_session_token&&window.location.reload()}function jt(n){return{menu_item_id:n.id,quantity:n.quantity}}function yt(n,e){return n+e.lineTotal}function wt(n,e){return n+e.quantity}function Nt(n){return!!n}function vt(n,e){return n[e.id]=e,n}function kt(n){return n.id}export{Lt as default};
